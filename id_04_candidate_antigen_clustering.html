<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 4 Candidate antigen clustering | Malaria vaccine antigen identification for Plasmodium falciparum</title>
  <meta name="description" content="Section 4 Candidate antigen clustering | Malaria vaccine antigen identification for Plasmodium falciparum" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 4 Candidate antigen clustering | Malaria vaccine antigen identification for Plasmodium falciparum" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 4 Candidate antigen clustering | Malaria vaccine antigen identification for Plasmodium falciparum" />
  
  
  

<meta name="author" content="" />


<meta name="date" content="2023-04-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="id_03_candidate_prioritization.html"/>
<link rel="next" href="id_05_further_characterization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.24/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.11.3/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.11.3/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<!-- https://stackoverflow.com/questions/45360998/code-folding-in-bookdown -->
<script type="text/javascript" src="js/transition.js"></script>
<script type="text/javascript" src="js/dropdown.js"></script>
<script>
var str = '<div class="btn-group pull-right" style="position: fixed; right: 50px; top: 10px; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" id="allCodeButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>';
document.write(str);
</script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><i>Positive-unlabeled learning for Pf RV</i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html"><i class="fa fa-check"></i><b>1</b> Data engineering</a>
<ul>
<li class="chapter" data-level="1.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#purf-package-installization"><i class="fa fa-check"></i><b>1.1</b> <code>purf</code> package installization</a></li>
<li class="chapter" data-level="1.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#retrieving-p.-falciparum-protein-variables"><i class="fa fa-check"></i><b>1.2</b> Retrieving <em>P. falciparum</em> protein variables</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#immunological-data-sets"><i class="fa fa-check"></i><b>1.2.1</b> Immunological data sets</a></li>
<li class="chapter" data-level="1.2.2" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#proteomic-data-sets"><i class="fa fa-check"></i><b>1.2.2</b> Proteomic data sets</a></li>
<li class="chapter" data-level="1.2.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#structural-data-sets"><i class="fa fa-check"></i><b>1.2.3</b> Structural data sets</a></li>
<li class="chapter" data-level="1.2.4" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#genomic-data-sets"><i class="fa fa-check"></i><b>1.2.4</b> Genomic data sets</a></li>
<li class="chapter" data-level="1.2.5" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#final-assembly"><i class="fa fa-check"></i><b>1.2.5</b> Final assembly</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="id_01_data_engineering.html"><a href="id_01_data_engineering.html#generating-ml-input"><i class="fa fa-check"></i><b>1.3</b> Generating ML input</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="id_02_model_training.html"><a href="id_02_model_training.html"><i class="fa fa-check"></i><b>2</b> Model training</a>
<ul>
<li class="chapter" data-level="2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#simulation-experiment-with-99-unlabeled-data-set."><i class="fa fa-check"></i><b>2.1</b> Simulation experiment with 99% unlabeled data set.</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#analysis"><i class="fa fa-check"></i><b>2.1.1</b> Analysis</a></li>
<li class="chapter" data-level="2.1.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#plotting"><i class="fa fa-check"></i><b>2.1.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#hyper-parameter-tuning-for-purf"><i class="fa fa-check"></i><b>2.2</b> Hyper-parameter tuning for PURF</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#analysis-1"><i class="fa fa-check"></i><b>2.2.1</b> Analysis</a></li>
<li class="chapter" data-level="2.2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#plotting-1"><i class="fa fa-check"></i><b>2.2.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="2.2.2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot"><i class="fa fa-check"></i><b>2.2.2.1</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.2.2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking"><i class="fa fa-check"></i><b>2.2.2.2</b> Known antigen ranking</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="id_02_model_training.html"><a href="id_02_model_training.html#variable-space-weighting"><i class="fa fa-check"></i><b>2.3</b> Variable space weighting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#analysis-2"><i class="fa fa-check"></i><b>2.3.1</b> Analysis</a></li>
<li class="chapter" data-level="2.3.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#plotting-2"><i class="fa fa-check"></i><b>2.3.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="2.3.2.1" data-path="id_02_model_training.html"><a href="id_02_model_training.html#bimodal-distribution-plot-1"><i class="fa fa-check"></i><b>2.3.2.1</b> Bimodal distribution plot</a></li>
<li class="chapter" data-level="2.3.2.2" data-path="id_02_model_training.html"><a href="id_02_model_training.html#known-antigen-ranking-1"><i class="fa fa-check"></i><b>2.3.2.2</b> Known antigen ranking</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html"><i class="fa fa-check"></i><b>3</b> Candidate prioritization</a>
<ul>
<li class="chapter" data-level="3.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#jackknife-based-validation-of-purf-models"><i class="fa fa-check"></i><b>3.1</b> Jackknife-based validation of PURF models</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#analysis-3"><i class="fa fa-check"></i><b>3.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.1.1.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#training-on-whole-data-set"><i class="fa fa-check"></i><b>3.1.1.1</b> Training on whole data set</a></li>
<li class="chapter" data-level="3.1.1.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#validation-for-purf-without-tree-filtering"><i class="fa fa-check"></i><b>3.1.1.2</b> Validation for PURF without tree filtering</a></li>
<li class="chapter" data-level="3.1.1.3" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#validation-for-purf-with-tree-filtering"><i class="fa fa-check"></i><b>3.1.1.3</b> Validation for PURF with tree filtering</a></li>
</ul></li>
<li class="chapter" data-level="3.1.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#plotting-3"><i class="fa fa-check"></i><b>3.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.1.2.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#plot-score-distribution"><i class="fa fa-check"></i><b>3.1.2.1</b> Plot score distribution</a></li>
<li class="chapter" data-level="3.1.2.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#percent-rank-for-labeled-positives"><i class="fa fa-check"></i><b>3.1.2.2</b> Percent rank for labeled positives</a></li>
<li class="chapter" data-level="3.1.2.3" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#comparison-of-known-antigens"><i class="fa fa-check"></i><b>3.1.2.3</b> Comparison of known antigens</a></li>
<li class="chapter" data-level="3.1.2.4" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#comparison-of-top-200-candidates"><i class="fa fa-check"></i><b>3.1.2.4</b> Comparison of top 200 candidates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#model-interpretation"><i class="fa fa-check"></i><b>3.2</b> Model interpretation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#analysis-4"><i class="fa fa-check"></i><b>3.2.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="3.2.1.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#variable-importance"><i class="fa fa-check"></i><b>3.2.1.1</b> Variable importance</a></li>
<li class="chapter" data-level="3.2.1.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#wilcoxon-test"><i class="fa fa-check"></i><b>3.2.1.2</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="3.2.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#plotting-4"><i class="fa fa-check"></i><b>3.2.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#variable-importance-1"><i class="fa fa-check"></i><b>3.2.2.1</b> Variable importance</a></li>
<li class="chapter" data-level="3.2.2.2" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#group-variable-importance"><i class="fa fa-check"></i><b>3.2.2.2</b> Group variable importance</a></li>
<li class="chapter" data-level="3.2.2.3" data-path="id_03_candidate_prioritization.html"><a href="id_03_candidate_prioritization.html#wilcoxon-test-1"><i class="fa fa-check"></i><b>3.2.2.3</b> Wilcoxon test</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html"><i class="fa fa-check"></i><b>4</b> Candidate antigen clustering</a>
<ul>
<li class="chapter" data-level="4.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#clustering-analysis-of-the-proximity-matrix-from-the-tree-filtered-purf-model"><i class="fa fa-check"></i><b>4.1</b> Clustering analysis of the proximity matrix from the tree-filtered PURF model</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#analysis-5"><i class="fa fa-check"></i><b>4.1.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="4.1.1.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#multi-dimensional-scaling"><i class="fa fa-check"></i><b>4.1.1.1</b> Multi-dimensional scaling</a></li>
</ul></li>
<li class="chapter" data-level="4.1.2" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#plotting-5"><i class="fa fa-check"></i><b>4.1.2</b> Plotting</a>
<ul>
<li class="chapter" data-level="4.1.2.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#clustering-on-candidate-antigens"><i class="fa fa-check"></i><b>4.1.2.1</b> Clustering on candidate antigens</a></li>
<li class="chapter" data-level="4.1.2.2" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#difference-in-scores"><i class="fa fa-check"></i><b>4.1.2.2</b> Difference in scores</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#comparison-of-the-candidate-clustering-groups"><i class="fa fa-check"></i><b>4.2</b> Comparison of the candidate clustering groups</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#plotting-6"><i class="fa fa-check"></i><b>4.2.1</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#important-variables-for-candidate-clustering-groups"><i class="fa fa-check"></i><b>4.3</b> Important variables for candidate clustering groups</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#analysis-6"><i class="fa fa-check"></i><b>4.3.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="4.3.1.1" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#variable-importance-2"><i class="fa fa-check"></i><b>4.3.1.1</b> Variable importance</a></li>
<li class="chapter" data-level="4.3.1.2" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#wilcoxon-test-2"><i class="fa fa-check"></i><b>4.3.1.2</b> Wilcoxon test</a></li>
</ul></li>
<li class="chapter" data-level="4.3.2" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#plotting-7"><i class="fa fa-check"></i><b>4.3.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="id_04_candidate_antigen_clustering.html"><a href="id_04_candidate_antigen_clustering.html#comparison-of-important-variables"><i class="fa fa-check"></i><b>4.4</b> Comparison of important variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html"><i class="fa fa-check"></i><b>5</b> Further characterization</a>
<ul>
<li class="chapter" data-level="5.1" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#gene-ontology-analysis"><i class="fa fa-check"></i><b>5.1</b> Gene ontology analysis</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#analysis-7"><i class="fa fa-check"></i><b>5.1.1</b> Analysis</a></li>
<li class="chapter" data-level="5.1.2" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#plotting-8"><i class="fa fa-check"></i><b>5.1.2</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#candidate-antigen-characterization"><i class="fa fa-check"></i><b>5.2</b> Candidate antigen characterization</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#analysis-8"><i class="fa fa-check"></i><b>5.2.1</b> Analysis</a>
<ul>
<li class="chapter" data-level="5.2.1.1" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#down-selection-with-essential-genes"><i class="fa fa-check"></i><b>5.2.1.1</b> Down-selection with essential genes</a></li>
<li class="chapter" data-level="5.2.1.2" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#characterization-using-scrna-seq"><i class="fa fa-check"></i><b>5.2.1.2</b> Characterization using scRNA-seq</a></li>
</ul></li>
<li class="chapter" data-level="5.2.2" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#processing-table"><i class="fa fa-check"></i><b>5.2.2</b> Processing table</a></li>
<li class="chapter" data-level="5.2.3" data-path="id_05_further_characterization.html"><a href="id_05_further_characterization.html#plotting-9"><i class="fa fa-check"></i><b>5.2.3</b> Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="id_06_summary_of_candidates.html"><a href="id_06_summary_of_candidates.html"><i class="fa fa-check"></i><b>6</b> Summary of candidates</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Malaria vaccine antigen identification for <em>Plasmodium falciparum</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="id_04_candidate_antigen_clustering" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Section 4</span> Candidate antigen clustering<a href="id_04_candidate_antigen_clustering.html#id_04_candidate_antigen_clustering" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="clustering-analysis-of-the-proximity-matrix-from-the-tree-filtered-purf-model" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Clustering analysis of the proximity matrix from the tree-filtered PURF model<a href="id_04_candidate_antigen_clustering.html#clustering-analysis-of-the-proximity-matrix-from-the-tree-filtered-purf-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="analysis-5" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Analysis<a href="id_04_candidate_antigen_clustering.html#analysis-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In Python: </strong></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb78-1"><a href="id_04_candidate_antigen_clustering.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb78-2"><a href="id_04_candidate_antigen_clustering.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb78-3"><a href="id_04_candidate_antigen_clustering.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb78-4"><a href="id_04_candidate_antigen_clustering.html#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> purf.pu_ensemble <span class="im">import</span> PURandomForestClassifier</span>
<span id="cb78-5"><a href="id_04_candidate_antigen_clustering.html#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble._forest <span class="im">import</span> _generate_unsampled_indices</span>
<span id="cb78-6"><a href="id_04_candidate_antigen_clustering.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing</span>
<span id="cb78-7"><a href="id_04_candidate_antigen_clustering.html#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> joblib <span class="im">import</span> Parallel, delayed</span>
<span id="cb78-8"><a href="id_04_candidate_antigen_clustering.html#cb78-8" aria-hidden="true" tabindex="-1"></a>num_cores <span class="op">=</span> multiprocessing.cpu_count()</span>
<span id="cb78-9"><a href="id_04_candidate_antigen_clustering.html#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> session_info</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb79-1"><a href="id_04_candidate_antigen_clustering.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># input set (5393, 1 + 272)</span></span>
<span id="cb79-2"><a href="id_04_candidate_antigen_clustering.html#cb79-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;./data/supplementary_data_3_pf_ml_input.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb79-3"><a href="id_04_candidate_antigen_clustering.html#cb79-3" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> data.iloc[:, <span class="dv">1</span>:]</span>
<span id="cb79-4"><a href="id_04_candidate_antigen_clustering.html#cb79-4" aria-hidden="true" tabindex="-1"></a>outcome <span class="op">=</span> np.array(data.antigen_label)</span>
<span id="cb79-5"><a href="id_04_candidate_antigen_clustering.html#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="id_04_candidate_antigen_clustering.html#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputation</span></span>
<span id="cb79-7"><a href="id_04_candidate_antigen_clustering.html#cb79-7" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> SimpleImputer(strategy<span class="op">=</span><span class="st">&#39;median&#39;</span>)</span>
<span id="cb79-8"><a href="id_04_candidate_antigen_clustering.html#cb79-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> imputer.fit_transform(features)</span>
<span id="cb79-9"><a href="id_04_candidate_antigen_clustering.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="id_04_candidate_antigen_clustering.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load model</span></span>
<span id="cb79-11"><a href="id_04_candidate_antigen_clustering.html#cb79-11" aria-hidden="true" tabindex="-1"></a>model_tree_filtered <span class="op">=</span> pickle.load(<span class="bu">open</span>(<span class="st">&#39;./pickle_data/0.5_purf_tree_filtering.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>))</span>
<span id="cb79-12"><a href="id_04_candidate_antigen_clustering.html#cb79-12" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> model_tree_filtered[<span class="st">&#39;model&#39;</span>]</span>
<span id="cb79-13"><a href="id_04_candidate_antigen_clustering.html#cb79-13" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> model_tree_filtered[<span class="st">&#39;weights&#39;</span>]</span>
<span id="cb79-14"><a href="id_04_candidate_antigen_clustering.html#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="id_04_candidate_antigen_clustering.html#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_proximity_(trees, y, leaf_indices):</span>
<span id="cb79-16"><a href="id_04_candidate_antigen_clustering.html#cb79-16" aria-hidden="true" tabindex="-1"></a>    same_leaf_mat <span class="op">=</span> np.zeros([y.shape[<span class="dv">0</span>], y.shape[<span class="dv">0</span>]])</span>
<span id="cb79-17"><a href="id_04_candidate_antigen_clustering.html#cb79-17" aria-hidden="true" tabindex="-1"></a>    same_oob_mat <span class="op">=</span> np.zeros([y.shape[<span class="dv">0</span>], y.shape[<span class="dv">0</span>]])</span>
<span id="cb79-18"><a href="id_04_candidate_antigen_clustering.html#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, tree <span class="kw">in</span> <span class="bu">enumerate</span>(trees):</span>
<span id="cb79-19"><a href="id_04_candidate_antigen_clustering.html#cb79-19" aria-hidden="true" tabindex="-1"></a>        oob_indices <span class="op">=</span> _generate_unsampled_indices(tree.random_state, y.shape[<span class="dv">0</span>], y.shape[<span class="dv">0</span>])</span>
<span id="cb79-20"><a href="id_04_candidate_antigen_clustering.html#cb79-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> oob_indices:</span>
<span id="cb79-21"><a href="id_04_candidate_antigen_clustering.html#cb79-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> oob_indices:</span>
<span id="cb79-22"><a href="id_04_candidate_antigen_clustering.html#cb79-22" aria-hidden="true" tabindex="-1"></a>                same_oob_mat[i, j] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb79-23"><a href="id_04_candidate_antigen_clustering.html#cb79-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> leaf_indices[i, idx] <span class="op">==</span> leaf_indices[j, idx]:</span>
<span id="cb79-24"><a href="id_04_candidate_antigen_clustering.html#cb79-24" aria-hidden="true" tabindex="-1"></a>                    same_leaf_mat[i, j] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb79-25"><a href="id_04_candidate_antigen_clustering.html#cb79-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (same_leaf_mat, same_oob_mat)</span>
<span id="cb79-26"><a href="id_04_candidate_antigen_clustering.html#cb79-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-27"><a href="id_04_candidate_antigen_clustering.html#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb79-28"><a href="id_04_candidate_antigen_clustering.html#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proximity without tree filtering</span></span>
<span id="cb79-29"><a href="id_04_candidate_antigen_clustering.html#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb79-30"><a href="id_04_candidate_antigen_clustering.html#cb79-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-31"><a href="id_04_candidate_antigen_clustering.html#cb79-31" aria-hidden="true" tabindex="-1"></a>trees <span class="op">=</span> model.estimators_</span>
<span id="cb79-32"><a href="id_04_candidate_antigen_clustering.html#cb79-32" aria-hidden="true" tabindex="-1"></a>leaf_indices <span class="op">=</span> model.<span class="bu">apply</span>(X)</span>
<span id="cb79-33"><a href="id_04_candidate_antigen_clustering.html#cb79-33" aria-hidden="true" tabindex="-1"></a>idx_list <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trees))]</span>
<span id="cb79-34"><a href="id_04_candidate_antigen_clustering.html#cb79-34" aria-hidden="true" tabindex="-1"></a>idx_list <span class="op">=</span> np.array_split(idx_list, <span class="dv">1000</span>)</span>
<span id="cb79-35"><a href="id_04_candidate_antigen_clustering.html#cb79-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-36"><a href="id_04_candidate_antigen_clustering.html#cb79-36" aria-hidden="true" tabindex="-1"></a>res_1 <span class="op">=</span> Parallel(n_jobs<span class="op">=</span>num_cores)(</span>
<span id="cb79-37"><a href="id_04_candidate_antigen_clustering.html#cb79-37" aria-hidden="true" tabindex="-1"></a>    delayed(calculate_proximity_)(<span class="bu">list</span>(trees[i] <span class="cf">for</span> i <span class="kw">in</span> idx), outcome, leaf_indices[:, idx]) <span class="cf">for</span> idx <span class="kw">in</span> idx_list[<span class="dv">0</span>:<span class="bu">round</span>(<span class="bu">len</span>(idx_list) <span class="op">/</span> <span class="dv">2</span>)])</span>
<span id="cb79-38"><a href="id_04_candidate_antigen_clustering.html#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Done first part!&#39;</span>)</span>
<span id="cb79-39"><a href="id_04_candidate_antigen_clustering.html#cb79-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-40"><a href="id_04_candidate_antigen_clustering.html#cb79-40" aria-hidden="true" tabindex="-1"></a>res_2 <span class="op">=</span> Parallel(n_jobs<span class="op">=</span>num_cores)(</span>
<span id="cb79-41"><a href="id_04_candidate_antigen_clustering.html#cb79-41" aria-hidden="true" tabindex="-1"></a>    delayed(calculate_proximity_)(<span class="bu">list</span>(trees[i] <span class="cf">for</span> i <span class="kw">in</span> idx), outcome, leaf_indices[:, idx]) <span class="cf">for</span> idx <span class="kw">in</span> idx_list[<span class="bu">round</span>(<span class="bu">len</span>(idx_list) <span class="op">/</span> <span class="dv">2</span>):])</span>
<span id="cb79-42"><a href="id_04_candidate_antigen_clustering.html#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Done second part!&#39;</span>)</span>
<span id="cb79-43"><a href="id_04_candidate_antigen_clustering.html#cb79-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-44"><a href="id_04_candidate_antigen_clustering.html#cb79-44" aria-hidden="true" tabindex="-1"></a>same_leaf_mat <span class="op">=</span> <span class="bu">sum</span>([r[<span class="dv">0</span>] <span class="cf">for</span> r <span class="kw">in</span> res_1 <span class="op">+</span> res_2])</span>
<span id="cb79-45"><a href="id_04_candidate_antigen_clustering.html#cb79-45" aria-hidden="true" tabindex="-1"></a>same_oob_mat <span class="op">=</span> <span class="bu">sum</span>([r[<span class="dv">1</span>] <span class="cf">for</span> r <span class="kw">in</span> res_1 <span class="op">+</span> res_2])</span>
<span id="cb79-46"><a href="id_04_candidate_antigen_clustering.html#cb79-46" aria-hidden="true" tabindex="-1"></a>prox_mat <span class="op">=</span> pd.DataFrame(np.divide(same_leaf_mat, same_oob_mat, out<span class="op">=</span>np.zeros_like(same_leaf_mat),</span>
<span id="cb79-47"><a href="id_04_candidate_antigen_clustering.html#cb79-47" aria-hidden="true" tabindex="-1"></a>                        where<span class="op">=</span>same_oob_mat<span class="op">!=</span><span class="dv">0</span>))</span>
<span id="cb79-48"><a href="id_04_candidate_antigen_clustering.html#cb79-48" aria-hidden="true" tabindex="-1"></a>prox_mat.index <span class="op">=</span> features.index</span>
<span id="cb79-49"><a href="id_04_candidate_antigen_clustering.html#cb79-49" aria-hidden="true" tabindex="-1"></a>prox_mat.columns <span class="op">=</span> features.index</span>
<span id="cb79-50"><a href="id_04_candidate_antigen_clustering.html#cb79-50" aria-hidden="true" tabindex="-1"></a>prox_mat.to_csv(<span class="st">&#39;./other_data/proximity_values.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-51"><a href="id_04_candidate_antigen_clustering.html#cb79-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-52"><a href="id_04_candidate_antigen_clustering.html#cb79-52" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb79-53"><a href="id_04_candidate_antigen_clustering.html#cb79-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate proximity with tree filtering</span></span>
<span id="cb79-54"><a href="id_04_candidate_antigen_clustering.html#cb79-54" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb79-55"><a href="id_04_candidate_antigen_clustering.html#cb79-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-56"><a href="id_04_candidate_antigen_clustering.html#cb79-56" aria-hidden="true" tabindex="-1"></a>trees <span class="op">=</span> model.estimators_</span>
<span id="cb79-57"><a href="id_04_candidate_antigen_clustering.html#cb79-57" aria-hidden="true" tabindex="-1"></a>leaf_indices <span class="op">=</span> model.<span class="bu">apply</span>(X)</span>
<span id="cb79-58"><a href="id_04_candidate_antigen_clustering.html#cb79-58" aria-hidden="true" tabindex="-1"></a>idx_list <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trees)) <span class="cf">if</span> weights[i] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb79-59"><a href="id_04_candidate_antigen_clustering.html#cb79-59" aria-hidden="true" tabindex="-1"></a>idx_list <span class="op">=</span> np.array_split(idx_list, <span class="dv">1000</span>)</span>
<span id="cb79-60"><a href="id_04_candidate_antigen_clustering.html#cb79-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-61"><a href="id_04_candidate_antigen_clustering.html#cb79-61" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> Parallel(n_jobs<span class="op">=</span>num_cores)(</span>
<span id="cb79-62"><a href="id_04_candidate_antigen_clustering.html#cb79-62" aria-hidden="true" tabindex="-1"></a>    delayed(calculate_proximity_)(<span class="bu">list</span>(trees[i] <span class="cf">for</span> i <span class="kw">in</span> idx), outcome, leaf_indices[:, idx]) <span class="cf">for</span> idx <span class="kw">in</span> idx_list)</span>
<span id="cb79-63"><a href="id_04_candidate_antigen_clustering.html#cb79-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-64"><a href="id_04_candidate_antigen_clustering.html#cb79-64" aria-hidden="true" tabindex="-1"></a>same_leaf_mat <span class="op">=</span> <span class="bu">sum</span>([r[<span class="dv">0</span>] <span class="cf">for</span> r <span class="kw">in</span> res])</span>
<span id="cb79-65"><a href="id_04_candidate_antigen_clustering.html#cb79-65" aria-hidden="true" tabindex="-1"></a>same_oob_mat <span class="op">=</span> <span class="bu">sum</span>([r[<span class="dv">1</span>] <span class="cf">for</span> r <span class="kw">in</span> res])</span>
<span id="cb79-66"><a href="id_04_candidate_antigen_clustering.html#cb79-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-67"><a href="id_04_candidate_antigen_clustering.html#cb79-67" aria-hidden="true" tabindex="-1"></a>prox_mat <span class="op">=</span> pd.DataFrame(np.divide(same_leaf_mat, same_oob_mat, out<span class="op">=</span>np.zeros_like(same_leaf_mat), </span>
<span id="cb79-68"><a href="id_04_candidate_antigen_clustering.html#cb79-68" aria-hidden="true" tabindex="-1"></a>                        where<span class="op">=</span>same_oob_mat<span class="op">!=</span><span class="dv">0</span>))</span>
<span id="cb79-69"><a href="id_04_candidate_antigen_clustering.html#cb79-69" aria-hidden="true" tabindex="-1"></a>prox_mat.index <span class="op">=</span> features.index</span>
<span id="cb79-70"><a href="id_04_candidate_antigen_clustering.html#cb79-70" aria-hidden="true" tabindex="-1"></a>prox_mat.columns <span class="op">=</span> features.index</span>
<span id="cb79-71"><a href="id_04_candidate_antigen_clustering.html#cb79-71" aria-hidden="true" tabindex="-1"></a>prox_mat.to_csv(<span class="st">&#39;./other_data/proximity_values_tree_filtering.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<div id="multi-dimensional-scaling" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Multi-dimensional scaling<a href="id_04_candidate_antigen_clustering.html#multi-dimensional-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb80-1"><a href="id_04_candidate_antigen_clustering.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multidimensional scaling</span></span>
<span id="cb80-2"><a href="id_04_candidate_antigen_clustering.html#cb80-2" aria-hidden="true" tabindex="-1"></a>prox_mat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/proximity_values_tree_filtering.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-3"><a href="id_04_candidate_antigen_clustering.html#cb80-3" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> <span class="fu">cmdscale</span>(<span class="fu">as.dist</span>(<span class="dv">1</span> <span class="sc">-</span> prox_mat), <span class="at">k =</span> <span class="fu">ncol</span>(prox_mat) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">eig =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-4"><a href="id_04_candidate_antigen_clustering.html#cb80-4" aria-hidden="true" tabindex="-1"></a>var_explained <span class="ot">&lt;-</span> <span class="fu">round</span>(mds<span class="sc">$</span>eig <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> <span class="fu">sum</span>(mds<span class="sc">$</span>eig), <span class="dv">2</span>)</span>
<span id="cb80-5"><a href="id_04_candidate_antigen_clustering.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Dimension 1 (&quot;</span>, var_explained[<span class="dv">1</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb80-6"><a href="id_04_candidate_antigen_clustering.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Dimension 2 (&quot;</span>, var_explained[<span class="dv">2</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb80-7"><a href="id_04_candidate_antigen_clustering.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Dimension 3 (&quot;</span>, var_explained[<span class="dv">3</span>], <span class="st">&quot;%)&quot;</span>))</span>
<span id="cb80-8"><a href="id_04_candidate_antigen_clustering.html#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="id_04_candidate_antigen_clustering.html#cb80-9" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mds<span class="sc">$</span>points)</span>
<span id="cb80-10"><a href="id_04_candidate_antigen_clustering.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(mds, <span class="st">&quot;./other_data/mds_proximity_values_tree_filtering.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="plotting-5" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Plotting<a href="id_04_candidate_antigen_clustering.html#plotting-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb81-1"><a href="id_04_candidate_antigen_clustering.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb81-2"><a href="id_04_candidate_antigen_clustering.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb81-3"><a href="id_04_candidate_antigen_clustering.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb81-4"><a href="id_04_candidate_antigen_clustering.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb81-5"><a href="id_04_candidate_antigen_clustering.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb81-6"><a href="id_04_candidate_antigen_clustering.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb81-7"><a href="id_04_candidate_antigen_clustering.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb81-8"><a href="id_04_candidate_antigen_clustering.html#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlist)</span>
<span id="cb81-9"><a href="id_04_candidate_antigen_clustering.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb81-10"><a href="id_04_candidate_antigen_clustering.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb81-11"><a href="id_04_candidate_antigen_clustering.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb81-12"><a href="id_04_candidate_antigen_clustering.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb81-13"><a href="id_04_candidate_antigen_clustering.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(umap)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb82-1"><a href="id_04_candidate_antigen_clustering.html#cb82-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_4_purf_oob_predictions.csv&quot;</span>)</span>
<span id="cb82-2"><a href="id_04_candidate_antigen_clustering.html#cb82-2" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> prediction[<span class="fu">order</span>(<span class="sc">-</span>prediction<span class="sc">$</span>oob_score_with_tree_filtering), ]</span>
<span id="cb82-3"><a href="id_04_candidate_antigen_clustering.html#cb82-3" aria-hidden="true" tabindex="-1"></a>top_200 <span class="ot">&lt;-</span> prediction[prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span>, ]<span class="sc">$</span>protein_id[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>]</span>
<span id="cb82-4"><a href="id_04_candidate_antigen_clustering.html#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="id_04_candidate_antigen_clustering.html#cb82-5" aria-hidden="true" tabindex="-1"></a>mds <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/mds_proximity_values_tree_filtering.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-6"><a href="id_04_candidate_antigen_clustering.html#cb82-6" aria-hidden="true" tabindex="-1"></a>mds_ <span class="ot">&lt;-</span> mds[<span class="fu">rownames</span>(mds) <span class="sc">%in%</span> top_200, ]</span></code></pre></div>
<div id="clustering-on-candidate-antigens" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Clustering on candidate antigens<a href="id_04_candidate_antigen_clustering.html#clustering-on-candidate-antigens" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb83-1"><a href="id_04_candidate_antigen_clustering.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gap statistic</span></span>
<span id="cb83-2"><a href="id_04_candidate_antigen_clustering.html#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-3"><a href="id_04_candidate_antigen_clustering.html#cb83-3" aria-hidden="true" tabindex="-1"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(mds_, kmeans, <span class="at">nstart =</span> <span class="dv">100</span>, <span class="at">K.max =</span> <span class="dv">10</span>, <span class="at">B =</span> <span class="dv">100</span>, <span class="at">iter.max =</span> <span class="dv">50</span>)</span>
<span id="cb83-4"><a href="id_04_candidate_antigen_clustering.html#cb83-4" aria-hidden="true" tabindex="-1"></a>p0_1 <span class="ot">&lt;-</span> <span class="fu">fviz_gap_stat</span>(gap_stat, <span class="at">maxSE =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;Tibs2001SEmax&quot;</span>, <span class="at">SE.factor =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb83-5"><a href="id_04_candidate_antigen_clustering.html#cb83-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gap statistic method&quot;</span>)</span>
<span id="cb83-6"><a href="id_04_candidate_antigen_clustering.html#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="id_04_candidate_antigen_clustering.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Silhouette method</span></span>
<span id="cb83-8"><a href="id_04_candidate_antigen_clustering.html#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-9"><a href="id_04_candidate_antigen_clustering.html#cb83-9" aria-hidden="true" tabindex="-1"></a>p0_2 <span class="ot">&lt;-</span> <span class="fu">fviz_nbclust</span>(mds_, kmeans, <span class="at">nstart =</span> <span class="dv">100</span>, <span class="at">method =</span> <span class="st">&quot;silhouette&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-10"><a href="id_04_candidate_antigen_clustering.html#cb83-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Silhouette method&quot;</span>)</span>
<span id="cb83-11"><a href="id_04_candidate_antigen_clustering.html#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="id_04_candidate_antigen_clustering.html#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Elbow method</span></span>
<span id="cb83-13"><a href="id_04_candidate_antigen_clustering.html#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb83-14"><a href="id_04_candidate_antigen_clustering.html#cb83-14" aria-hidden="true" tabindex="-1"></a>p0_3 <span class="ot">&lt;-</span> <span class="fu">fviz_nbclust</span>(mds_, kmeans, <span class="at">nstart =</span> <span class="dv">100</span>, <span class="at">method =</span> <span class="st">&quot;wss&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-15"><a href="id_04_candidate_antigen_clustering.html#cb83-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb83-16"><a href="id_04_candidate_antigen_clustering.html#cb83-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Elbow method&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb84-1"><a href="id_04_candidate_antigen_clustering.html#cb84-1" aria-hidden="true" tabindex="-1"></a>label <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_antigen_labels.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb84-2"><a href="id_04_candidate_antigen_clustering.html#cb84-2" aria-hidden="true" tabindex="-1"></a>label<span class="sc">$</span>antigen_label[<span class="fu">rownames</span>(label) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>)] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb84-3"><a href="id_04_candidate_antigen_clustering.html#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="id_04_candidate_antigen_clustering.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Clustering</span></span>
<span id="cb84-5"><a href="id_04_candidate_antigen_clustering.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb84-6"><a href="id_04_candidate_antigen_clustering.html#cb84-6" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(mds_, <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">100</span>)<span class="sc">$</span>cluster</span>
<span id="cb84-7"><a href="id_04_candidate_antigen_clustering.html#cb84-7" aria-hidden="true" tabindex="-1"></a>label<span class="sc">$</span>antigen_label[<span class="fu">rownames</span>(label) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb84-8"><a href="id_04_candidate_antigen_clustering.html#cb84-8" aria-hidden="true" tabindex="-1"></a>label<span class="sc">$</span>antigen_label[<span class="fu">rownames</span>(label) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">2</span>]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb84-9"><a href="id_04_candidate_antigen_clustering.html#cb84-9" aria-hidden="true" tabindex="-1"></a>label<span class="sc">$</span>antigen_label[<span class="fu">rownames</span>(label) <span class="sc">%in%</span> <span class="fu">names</span>(clusters)[clusters <span class="sc">==</span> <span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">3</span></span>
<span id="cb84-10"><a href="id_04_candidate_antigen_clustering.html#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="id_04_candidate_antigen_clustering.html#cb84-11" aria-hidden="true" tabindex="-1"></a>protein_id_1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(label)[label<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb84-12"><a href="id_04_candidate_antigen_clustering.html#cb84-12" aria-hidden="true" tabindex="-1"></a>protein_id_2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(label)[label<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="sc">-</span><span class="dv">2</span>]</span>
<span id="cb84-13"><a href="id_04_candidate_antigen_clustering.html#cb84-13" aria-hidden="true" tabindex="-1"></a>protein_id_3 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(label)[label<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="sc">-</span><span class="dv">3</span>]</span>
<span id="cb84-14"><a href="id_04_candidate_antigen_clustering.html#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="id_04_candidate_antigen_clustering.html#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(protein_id_1, protein_id_2, protein_id_3, <span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb85-1"><a href="id_04_candidate_antigen_clustering.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save candidate gene accessions for GO enrichment analysis</span></span>
<span id="cb85-2"><a href="id_04_candidate_antigen_clustering.html#cb85-2" aria-hidden="true" tabindex="-1"></a>gene_accession_1 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_1, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb85-3"><a href="id_04_candidate_antigen_clustering.html#cb85-3" aria-hidden="true" tabindex="-1"></a>gene_accession_2 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_2, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb85-4"><a href="id_04_candidate_antigen_clustering.html#cb85-4" aria-hidden="true" tabindex="-1"></a>gene_accession_3 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(protein_id_3, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.[1-9]-p1&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb85-5"><a href="id_04_candidate_antigen_clustering.html#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="id_04_candidate_antigen_clustering.html#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_1),</span>
<span id="cb85-7"><a href="id_04_candidate_antigen_clustering.html#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-8"><a href="id_04_candidate_antigen_clustering.html#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_200_candidates_gene_accession_1.csv&quot;</span></span>
<span id="cb85-9"><a href="id_04_candidate_antigen_clustering.html#cb85-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-10"><a href="id_04_candidate_antigen_clustering.html#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_2),</span>
<span id="cb85-11"><a href="id_04_candidate_antigen_clustering.html#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-12"><a href="id_04_candidate_antigen_clustering.html#cb85-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_200_candidates_gene_accession_2.csv&quot;</span></span>
<span id="cb85-13"><a href="id_04_candidate_antigen_clustering.html#cb85-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-14"><a href="id_04_candidate_antigen_clustering.html#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(<span class="fu">data.frame</span>(<span class="st">&quot;acc&quot;</span> <span class="ot">=</span> gene_accession_3),</span>
<span id="cb85-15"><a href="id_04_candidate_antigen_clustering.html#cb85-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>, <span class="at">col.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-16"><a href="id_04_candidate_antigen_clustering.html#cb85-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">file =</span> <span class="st">&quot;./other_data/top_200_candidates_gene_accession_3.csv&quot;</span></span>
<span id="cb85-17"><a href="id_04_candidate_antigen_clustering.html#cb85-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb86-1"><a href="id_04_candidate_antigen_clustering.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb86-2"><a href="id_04_candidate_antigen_clustering.html#cb86-2" aria-hidden="true" tabindex="-1"></a>umap_res <span class="ot">&lt;-</span> <span class="fu">umap</span>(mds)</span>
<span id="cb86-3"><a href="id_04_candidate_antigen_clustering.html#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="id_04_candidate_antigen_clustering.html#cb86-4" aria-hidden="true" tabindex="-1"></a>umap_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(umap_res<span class="sc">$</span>layout)</span>
<span id="cb86-5"><a href="id_04_candidate_antigen_clustering.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(umap_df) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mds)</span>
<span id="cb86-6"><a href="id_04_candidate_antigen_clustering.html#cb86-6" aria-hidden="true" tabindex="-1"></a>umap_df<span class="sc">$</span>label <span class="ot">&lt;-</span> label<span class="sc">$</span>antigen_label</span>
<span id="cb86-7"><a href="id_04_candidate_antigen_clustering.html#cb86-7" aria-hidden="true" tabindex="-1"></a>umap_df_subset <span class="ot">&lt;-</span> umap_df[umap_df<span class="sc">$</span>label <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>), ]</span>
<span id="cb86-8"><a href="id_04_candidate_antigen_clustering.html#cb86-8" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">factor</span>(umap_df_subset<span class="sc">$</span>label)</span>
<span id="cb86-9"><a href="id_04_candidate_antigen_clustering.html#cb86-9" aria-hidden="true" tabindex="-1"></a>umap_df_subset <span class="ot">&lt;-</span> umap_df_subset[<span class="fu">order</span>(umap_df_subset<span class="sc">$</span>label), ]</span>
<span id="cb86-10"><a href="id_04_candidate_antigen_clustering.html#cb86-10" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label_text <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb86-11"><a href="id_04_candidate_antigen_clustering.html#cb86-11" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_subset) <span class="sc">==</span> <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;CSP&quot;</span></span>
<span id="cb86-12"><a href="id_04_candidate_antigen_clustering.html#cb86-12" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_subset) <span class="sc">==</span> <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;RH5&quot;</span></span>
<span id="cb86-13"><a href="id_04_candidate_antigen_clustering.html#cb86-13" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_subset) <span class="sc">==</span> <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;MSP5&quot;</span></span>
<span id="cb86-14"><a href="id_04_candidate_antigen_clustering.html#cb86-14" aria-hidden="true" tabindex="-1"></a>umap_df_subset<span class="sc">$</span>label_text[<span class="fu">rownames</span>(umap_df_subset) <span class="sc">==</span> <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;P230&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb87-1"><a href="id_04_candidate_antigen_clustering.html#cb87-1" aria-hidden="true" tabindex="-1"></a>p1_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> umap_df_subset, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">V1</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">V2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb87-2"><a href="id_04_candidate_antigen_clustering.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> label), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-3"><a href="id_04_candidate_antigen_clustering.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># geom_mark_ellipse(aes(fill=label, filter=!label %in% c(1,2)), size=0, alpha=0.2, expand=unit(1, &quot;mm&quot;), color=&#39;grey90&#39;) +</span></span>
<span id="cb87-4"><a href="id_04_candidate_antigen_clustering.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#03a1fc&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>, <span class="st">&quot;#b8ffe0&quot;</span>, <span class="st">&quot;#ffee00&quot;</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Candidate antigen (Group 1)&quot;</span>, <span class="st">&quot;Candidate antigen (Group 2)&quot;</span>, <span class="st">&quot;Candidate antigen (Group 3)&quot;</span>, <span class="st">&quot;Known antigen&quot;</span>, <span class="st">&quot;Reference antigen&quot;</span>)) <span class="sc">+</span></span>
<span id="cb87-5"><a href="id_04_candidate_antigen_clustering.html#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label_text), <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">nudge_x =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">nudge_y =</span> <span class="dv">1</span>, <span class="at">point.padding =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb87-6"><a href="id_04_candidate_antigen_clustering.html#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb87-7"><a href="id_04_candidate_antigen_clustering.html#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb87-8"><a href="id_04_candidate_antigen_clustering.html#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb87-9"><a href="id_04_candidate_antigen_clustering.html#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb87-10"><a href="id_04_candidate_antigen_clustering.html#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb87-11"><a href="id_04_candidate_antigen_clustering.html#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb87-12"><a href="id_04_candidate_antigen_clustering.html#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb87-13"><a href="id_04_candidate_antigen_clustering.html#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb87-14"><a href="id_04_candidate_antigen_clustering.html#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb87-15"><a href="id_04_candidate_antigen_clustering.html#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb87-16"><a href="id_04_candidate_antigen_clustering.html#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb87-17"><a href="id_04_candidate_antigen_clustering.html#cb87-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.key =</span> <span class="fu">element_blank</span>()</span>
<span id="cb87-18"><a href="id_04_candidate_antigen_clustering.html#cb87-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb87-19"><a href="id_04_candidate_antigen_clustering.html#cb87-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">min</span>(umap_df_subset<span class="sc">$</span><span class="st">`</span><span class="at">V1</span><span class="st">`</span>), <span class="fu">max</span>(umap_df_subset<span class="sc">$</span><span class="st">`</span><span class="at">V1</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb87-20"><a href="id_04_candidate_antigen_clustering.html#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">min</span>(umap_df_subset<span class="sc">$</span><span class="st">`</span><span class="at">V2</span><span class="st">`</span>), <span class="fu">max</span>(umap_df_subset<span class="sc">$</span><span class="st">`</span><span class="at">V2</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb87-21"><a href="id_04_candidate_antigen_clustering.html#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Dimension 1&quot;</span>) <span class="sc">+</span></span>
<span id="cb87-22"><a href="id_04_candidate_antigen_clustering.html#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Dimension 2&quot;</span>)</span></code></pre></div>
</div>
<div id="difference-in-scores" class="section level4 hasAnchor" number="4.1.2.2">
<h4><span class="header-section-number">4.1.2.2</span> Difference in scores<a href="id_04_candidate_antigen_clustering.html#difference-in-scores" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Prediction scores of clustering groups before and after tree filtering.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb88-1"><a href="id_04_candidate_antigen_clustering.html#cb88-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_4_purf_oob_predictions.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb88-2"><a href="id_04_candidate_antigen_clustering.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span>
<span id="cb88-3"><a href="id_04_candidate_antigen_clustering.html#cb88-3" aria-hidden="true" tabindex="-1"></a>data_subset <span class="ot">&lt;-</span> prediction[<span class="fu">rownames</span>(prediction) <span class="sc">%in%</span> <span class="fu">c</span>(protein_id_1, protein_id_2, protein_id_3), ]</span>
<span id="cb88-4"><a href="id_04_candidate_antigen_clustering.html#cb88-4" aria-hidden="true" tabindex="-1"></a>data_subset<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-5"><a href="id_04_candidate_antigen_clustering.html#cb88-5" aria-hidden="true" tabindex="-1"></a>data_subset<span class="sc">$</span>label[<span class="fu">rownames</span>(data_subset) <span class="sc">%in%</span> protein_id_1] <span class="ot">&lt;-</span> <span class="st">&quot;Group 1&quot;</span></span>
<span id="cb88-6"><a href="id_04_candidate_antigen_clustering.html#cb88-6" aria-hidden="true" tabindex="-1"></a>data_subset<span class="sc">$</span>label[<span class="fu">rownames</span>(data_subset) <span class="sc">%in%</span> protein_id_2] <span class="ot">&lt;-</span> <span class="st">&quot;Group 2&quot;</span></span>
<span id="cb88-7"><a href="id_04_candidate_antigen_clustering.html#cb88-7" aria-hidden="true" tabindex="-1"></a>data_subset<span class="sc">$</span>label[<span class="fu">rownames</span>(data_subset) <span class="sc">%in%</span> protein_id_3] <span class="ot">&lt;-</span> <span class="st">&quot;Group 3&quot;</span></span>
<span id="cb88-8"><a href="id_04_candidate_antigen_clustering.html#cb88-8" aria-hidden="true" tabindex="-1"></a>data_subset<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_subset<span class="sc">$</span>label)</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb89-1"><a href="id_04_candidate_antigen_clustering.html#cb89-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb89-2"><a href="id_04_candidate_antigen_clustering.html#cb89-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb89-3"><a href="id_04_candidate_antigen_clustering.html#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb89-4"><a href="id_04_candidate_antigen_clustering.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  ds_ <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_subset[data_subset<span class="sc">$</span>label <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">&quot;Group &quot;</span>, i), ])</span>
<span id="cb89-5"><a href="id_04_candidate_antigen_clustering.html#cb89-5" aria-hidden="true" tabindex="-1"></a>  ds_<span class="sc">$</span>paired <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(ds_) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb89-6"><a href="id_04_candidate_antigen_clustering.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">c</span>(pval, <span class="fu">compare_means</span>(value <span class="sc">~</span> variable, <span class="at">data =</span> ds_, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p)</span>
<span id="cb89-7"><a href="id_04_candidate_antigen_clustering.html#cb89-7" aria-hidden="true" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">list.append</span>(ds, ds_)</span>
<span id="cb89-8"><a href="id_04_candidate_antigen_clustering.html#cb89-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-9"><a href="id_04_candidate_antigen_clustering.html#cb89-9" aria-hidden="true" tabindex="-1"></a>adj_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> <span class="fu">length</span>(pval))</span>
<span id="cb89-10"><a href="id_04_candidate_antigen_clustering.html#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="id_04_candidate_antigen_clustering.html#cb89-11" aria-hidden="true" tabindex="-1"></a>p2_1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds[[<span class="dv">1</span>]], <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb89-12"><a href="id_04_candidate_antigen_clustering.html#cb89-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb89-13"><a href="id_04_candidate_antigen_clustering.html#cb89-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> paired), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-14"><a href="id_04_candidate_antigen_clustering.html#cb89-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb89-15"><a href="id_04_candidate_antigen_clustering.html#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">2.5</span>, <span class="at">priority =</span> <span class="st">&quot;random&quot;</span>,</span>
<span id="cb89-16"><a href="id_04_candidate_antigen_clustering.html#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb89-17"><a href="id_04_candidate_antigen_clustering.html#cb89-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-18"><a href="id_04_candidate_antigen_clustering.html#cb89-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=2, y=0.991, yend=0.991, colour=&quot;black&quot;) +</span></span>
<span id="cb89-19"><a href="id_04_candidate_antigen_clustering.html#cb89-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=1, y=0.991, yend=0.989, colour=&quot;black&quot;) +</span></span>
<span id="cb89-20"><a href="id_04_candidate_antigen_clustering.html#cb89-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=2, xend=2, y=0.991, yend=0.989, colour=&quot;black&quot;) +</span></span>
<span id="cb89-21"><a href="id_04_candidate_antigen_clustering.html#cb89-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">0.994</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, <span class="fu">round</span>(adj_pval[<span class="dv">1</span>], <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb89-22"><a href="id_04_candidate_antigen_clustering.html#cb89-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb89-23"><a href="id_04_candidate_antigen_clustering.html#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-24"><a href="id_04_candidate_antigen_clustering.html#cb89-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-25"><a href="id_04_candidate_antigen_clustering.html#cb89-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-26"><a href="id_04_candidate_antigen_clustering.html#cb89-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-27"><a href="id_04_candidate_antigen_clustering.html#cb89-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#f7d59e&quot;</span>, <span class="st">&quot;#fcd7d7&quot;</span>),</span>
<span id="cb89-28"><a href="id_04_candidate_antigen_clustering.html#cb89-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-29"><a href="id_04_candidate_antigen_clustering.html#cb89-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-30"><a href="id_04_candidate_antigen_clustering.html#cb89-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb89-31"><a href="id_04_candidate_antigen_clustering.html#cb89-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-32"><a href="id_04_candidate_antigen_clustering.html#cb89-32" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-33"><a href="id_04_candidate_antigen_clustering.html#cb89-33" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-34"><a href="id_04_candidate_antigen_clustering.html#cb89-34" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-35"><a href="id_04_candidate_antigen_clustering.html#cb89-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#fc9d03&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb89-36"><a href="id_04_candidate_antigen_clustering.html#cb89-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-37"><a href="id_04_candidate_antigen_clustering.html#cb89-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-38"><a href="id_04_candidate_antigen_clustering.html#cb89-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb89-39"><a href="id_04_candidate_antigen_clustering.html#cb89-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-40"><a href="id_04_candidate_antigen_clustering.html#cb89-40" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-41"><a href="id_04_candidate_antigen_clustering.html#cb89-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-42"><a href="id_04_candidate_antigen_clustering.html#cb89-42" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-43"><a href="id_04_candidate_antigen_clustering.html#cb89-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-44"><a href="id_04_candidate_antigen_clustering.html#cb89-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-45"><a href="id_04_candidate_antigen_clustering.html#cb89-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb89-46"><a href="id_04_candidate_antigen_clustering.html#cb89-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-47"><a href="id_04_candidate_antigen_clustering.html#cb89-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-48"><a href="id_04_candidate_antigen_clustering.html#cb89-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-49"><a href="id_04_candidate_antigen_clustering.html#cb89-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb89-50"><a href="id_04_candidate_antigen_clustering.html#cb89-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-51"><a href="id_04_candidate_antigen_clustering.html#cb89-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-52"><a href="id_04_candidate_antigen_clustering.html#cb89-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb89-53"><a href="id_04_candidate_antigen_clustering.html#cb89-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-54"><a href="id_04_candidate_antigen_clustering.html#cb89-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb89-55"><a href="id_04_candidate_antigen_clustering.html#cb89-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-56"><a href="id_04_candidate_antigen_clustering.html#cb89-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-57"><a href="id_04_candidate_antigen_clustering.html#cb89-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Score (proportion of votes)&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-58"><a href="id_04_candidate_antigen_clustering.html#cb89-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.935</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-59"><a href="id_04_candidate_antigen_clustering.html#cb89-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 1&quot;</span>)</span>
<span id="cb89-60"><a href="id_04_candidate_antigen_clustering.html#cb89-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-61"><a href="id_04_candidate_antigen_clustering.html#cb89-61" aria-hidden="true" tabindex="-1"></a>p2_2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds[[<span class="dv">2</span>]], <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb89-62"><a href="id_04_candidate_antigen_clustering.html#cb89-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb89-63"><a href="id_04_candidate_antigen_clustering.html#cb89-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> paired), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-64"><a href="id_04_candidate_antigen_clustering.html#cb89-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb89-65"><a href="id_04_candidate_antigen_clustering.html#cb89-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">2.5</span>, <span class="at">priority =</span> <span class="st">&quot;random&quot;</span>,</span>
<span id="cb89-66"><a href="id_04_candidate_antigen_clustering.html#cb89-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb89-67"><a href="id_04_candidate_antigen_clustering.html#cb89-67" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-68"><a href="id_04_candidate_antigen_clustering.html#cb89-68" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=2, y=0.997, yend=0.997, colour=&quot;black&quot;) +</span></span>
<span id="cb89-69"><a href="id_04_candidate_antigen_clustering.html#cb89-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=1, y=0.997, yend=0.995, colour=&quot;black&quot;) +</span></span>
<span id="cb89-70"><a href="id_04_candidate_antigen_clustering.html#cb89-70" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=2, xend=2, y=0.997, yend=0.995, colour=&quot;black&quot;) +</span></span>
<span id="cb89-71"><a href="id_04_candidate_antigen_clustering.html#cb89-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, <span class="fu">round</span>(adj_pval[<span class="dv">2</span>], <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb89-72"><a href="id_04_candidate_antigen_clustering.html#cb89-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb89-73"><a href="id_04_candidate_antigen_clustering.html#cb89-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-74"><a href="id_04_candidate_antigen_clustering.html#cb89-74" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-75"><a href="id_04_candidate_antigen_clustering.html#cb89-75" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-76"><a href="id_04_candidate_antigen_clustering.html#cb89-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-77"><a href="id_04_candidate_antigen_clustering.html#cb89-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#f7d59e&quot;</span>, <span class="st">&quot;#fcd7d7&quot;</span>),</span>
<span id="cb89-78"><a href="id_04_candidate_antigen_clustering.html#cb89-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-79"><a href="id_04_candidate_antigen_clustering.html#cb89-79" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-80"><a href="id_04_candidate_antigen_clustering.html#cb89-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb89-81"><a href="id_04_candidate_antigen_clustering.html#cb89-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-82"><a href="id_04_candidate_antigen_clustering.html#cb89-82" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-83"><a href="id_04_candidate_antigen_clustering.html#cb89-83" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-84"><a href="id_04_candidate_antigen_clustering.html#cb89-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-85"><a href="id_04_candidate_antigen_clustering.html#cb89-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#fc9d03&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb89-86"><a href="id_04_candidate_antigen_clustering.html#cb89-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-87"><a href="id_04_candidate_antigen_clustering.html#cb89-87" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-88"><a href="id_04_candidate_antigen_clustering.html#cb89-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb89-89"><a href="id_04_candidate_antigen_clustering.html#cb89-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-90"><a href="id_04_candidate_antigen_clustering.html#cb89-90" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-91"><a href="id_04_candidate_antigen_clustering.html#cb89-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-92"><a href="id_04_candidate_antigen_clustering.html#cb89-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-93"><a href="id_04_candidate_antigen_clustering.html#cb89-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-94"><a href="id_04_candidate_antigen_clustering.html#cb89-94" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-95"><a href="id_04_candidate_antigen_clustering.html#cb89-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb89-96"><a href="id_04_candidate_antigen_clustering.html#cb89-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-97"><a href="id_04_candidate_antigen_clustering.html#cb89-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-98"><a href="id_04_candidate_antigen_clustering.html#cb89-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-99"><a href="id_04_candidate_antigen_clustering.html#cb89-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb89-100"><a href="id_04_candidate_antigen_clustering.html#cb89-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-101"><a href="id_04_candidate_antigen_clustering.html#cb89-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb89-102"><a href="id_04_candidate_antigen_clustering.html#cb89-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-103"><a href="id_04_candidate_antigen_clustering.html#cb89-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-104"><a href="id_04_candidate_antigen_clustering.html#cb89-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-105"><a href="id_04_candidate_antigen_clustering.html#cb89-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb89-106"><a href="id_04_candidate_antigen_clustering.html#cb89-106" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-107"><a href="id_04_candidate_antigen_clustering.html#cb89-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-108"><a href="id_04_candidate_antigen_clustering.html#cb89-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-109"><a href="id_04_candidate_antigen_clustering.html#cb89-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.935</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-110"><a href="id_04_candidate_antigen_clustering.html#cb89-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 2&quot;</span>)</span>
<span id="cb89-111"><a href="id_04_candidate_antigen_clustering.html#cb89-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-112"><a href="id_04_candidate_antigen_clustering.html#cb89-112" aria-hidden="true" tabindex="-1"></a>p2_3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds[[<span class="dv">3</span>]], <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb89-113"><a href="id_04_candidate_antigen_clustering.html#cb89-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb89-114"><a href="id_04_candidate_antigen_clustering.html#cb89-114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> paired), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-115"><a href="id_04_candidate_antigen_clustering.html#cb89-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb89-116"><a href="id_04_candidate_antigen_clustering.html#cb89-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">2.5</span>, <span class="at">priority =</span> <span class="st">&quot;random&quot;</span>,</span>
<span id="cb89-117"><a href="id_04_candidate_antigen_clustering.html#cb89-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb89-118"><a href="id_04_candidate_antigen_clustering.html#cb89-118" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-119"><a href="id_04_candidate_antigen_clustering.html#cb89-119" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=2, y=0.997, yend=0.997, colour=&quot;black&quot;) +</span></span>
<span id="cb89-120"><a href="id_04_candidate_antigen_clustering.html#cb89-120" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=1, xend=1, y=0.997, yend=0.995, colour=&quot;black&quot;) +</span></span>
<span id="cb89-121"><a href="id_04_candidate_antigen_clustering.html#cb89-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># annotate(&quot;segment&quot;, x=2, xend=2, y=0.997, yend=0.995, colour=&quot;black&quot;) +</span></span>
<span id="cb89-122"><a href="id_04_candidate_antigen_clustering.html#cb89-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="dv">1</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, <span class="fu">round</span>(adj_pval[<span class="dv">3</span>], <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb89-123"><a href="id_04_candidate_antigen_clustering.html#cb89-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb89-124"><a href="id_04_candidate_antigen_clustering.html#cb89-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-125"><a href="id_04_candidate_antigen_clustering.html#cb89-125" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-126"><a href="id_04_candidate_antigen_clustering.html#cb89-126" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-127"><a href="id_04_candidate_antigen_clustering.html#cb89-127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-128"><a href="id_04_candidate_antigen_clustering.html#cb89-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#f7d59e&quot;</span>, <span class="st">&quot;#fcd7d7&quot;</span>),</span>
<span id="cb89-129"><a href="id_04_candidate_antigen_clustering.html#cb89-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-130"><a href="id_04_candidate_antigen_clustering.html#cb89-130" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-131"><a href="id_04_candidate_antigen_clustering.html#cb89-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb89-132"><a href="id_04_candidate_antigen_clustering.html#cb89-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-133"><a href="id_04_candidate_antigen_clustering.html#cb89-133" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-134"><a href="id_04_candidate_antigen_clustering.html#cb89-134" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-135"><a href="id_04_candidate_antigen_clustering.html#cb89-135" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-136"><a href="id_04_candidate_antigen_clustering.html#cb89-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#fc9d03&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb89-137"><a href="id_04_candidate_antigen_clustering.html#cb89-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-138"><a href="id_04_candidate_antigen_clustering.html#cb89-138" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-139"><a href="id_04_candidate_antigen_clustering.html#cb89-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb89-140"><a href="id_04_candidate_antigen_clustering.html#cb89-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(</span>
<span id="cb89-141"><a href="id_04_candidate_antigen_clustering.html#cb89-141" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_without_tree_filtering&quot;</span>,</span>
<span id="cb89-142"><a href="id_04_candidate_antigen_clustering.html#cb89-142" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;oob_score_with_tree_filtering&quot;</span></span>
<span id="cb89-143"><a href="id_04_candidate_antigen_clustering.html#cb89-143" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb89-144"><a href="id_04_candidate_antigen_clustering.html#cb89-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb89-145"><a href="id_04_candidate_antigen_clustering.html#cb89-145" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-146"><a href="id_04_candidate_antigen_clustering.html#cb89-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb89-147"><a href="id_04_candidate_antigen_clustering.html#cb89-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb89-148"><a href="id_04_candidate_antigen_clustering.html#cb89-148" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-149"><a href="id_04_candidate_antigen_clustering.html#cb89-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-150"><a href="id_04_candidate_antigen_clustering.html#cb89-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb89-151"><a href="id_04_candidate_antigen_clustering.html#cb89-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-152"><a href="id_04_candidate_antigen_clustering.html#cb89-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">30</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb89-153"><a href="id_04_candidate_antigen_clustering.html#cb89-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-154"><a href="id_04_candidate_antigen_clustering.html#cb89-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-155"><a href="id_04_candidate_antigen_clustering.html#cb89-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb89-156"><a href="id_04_candidate_antigen_clustering.html#cb89-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb89-157"><a href="id_04_candidate_antigen_clustering.html#cb89-157" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-158"><a href="id_04_candidate_antigen_clustering.html#cb89-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-159"><a href="id_04_candidate_antigen_clustering.html#cb89-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb89-160"><a href="id_04_candidate_antigen_clustering.html#cb89-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.935</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-161"><a href="id_04_candidate_antigen_clustering.html#cb89-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 3&quot;</span>)</span></code></pre></div>
<p><strong>Final plot</strong></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb90-1"><a href="id_04_candidate_antigen_clustering.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_1 = plot_grid(p1_1, legend_1, p1_2, p1_3, nrow=2, rel_widths=c(0.5, 0.5))</span></span>
<span id="cb90-2"><a href="id_04_candidate_antigen_clustering.html#cb90-2" aria-hidden="true" tabindex="-1"></a>p_2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p2_1, p2_2, p2_3, <span class="cn">NULL</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.28</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.03</span>))</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb91-1"><a href="id_04_candidate_antigen_clustering.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;./figures/Fig 4.png&quot;</span>, <span class="at">width =</span> <span class="dv">3500</span>, <span class="at">height =</span> <span class="dv">2200</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb91-2"><a href="id_04_candidate_antigen_clustering.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1_1)</span>
<span id="cb91-3"><a href="id_04_candidate_antigen_clustering.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb91-4"><a href="id_04_candidate_antigen_clustering.html#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="id_04_candidate_antigen_clustering.html#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;../figures/Fig 4.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">7</span>, <span class="at">height =</span> <span class="fl">4.4</span>)</span>
<span id="cb91-6"><a href="id_04_candidate_antigen_clustering.html#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1_1)</span>
<span id="cb91-7"><a href="id_04_candidate_antigen_clustering.html#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb91-8"><a href="id_04_candidate_antigen_clustering.html#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="id_04_candidate_antigen_clustering.html#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">file =</span> <span class="st">&quot;./figures/Supplementary Fig 8.png&quot;</span>, <span class="at">width =</span> <span class="dv">6000</span>, <span class="at">height =</span> <span class="dv">4000</span>, <span class="at">res =</span> <span class="dv">600</span>)</span>
<span id="cb91-10"><a href="id_04_candidate_antigen_clustering.html#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_2)</span>
<span id="cb91-11"><a href="id_04_candidate_antigen_clustering.html#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span>
<span id="cb91-12"><a href="id_04_candidate_antigen_clustering.html#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="id_04_candidate_antigen_clustering.html#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">&quot;../supplementary_figures/Supplementary Fig 8.pdf&quot;</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>)</span>
<span id="cb91-14"><a href="id_04_candidate_antigen_clustering.html#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_2)</span>
<span id="cb91-15"><a href="id_04_candidate_antigen_clustering.html#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<p><img src="figures/Fig%204.png" width="100%" style="display: block; margin: auto;" /><img src="figures/Supplementary%20Fig%208.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="comparison-of-the-candidate-clustering-groups" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Comparison of the candidate clustering groups<a href="id_04_candidate_antigen_clustering.html#comparison-of-the-candidate-clustering-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comparisons of clustering groups before and after tree filtering in terms of distances to reference antigens and predictions scores.</p>
<div id="plotting-6" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Plotting<a href="id_04_candidate_antigen_clustering.html#plotting-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb92-1"><a href="id_04_candidate_antigen_clustering.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb92-2"><a href="id_04_candidate_antigen_clustering.html#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbeeswarm)</span>
<span id="cb92-3"><a href="id_04_candidate_antigen_clustering.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb92-4"><a href="id_04_candidate_antigen_clustering.html#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb92-5"><a href="id_04_candidate_antigen_clustering.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlist)</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb93-1"><a href="id_04_candidate_antigen_clustering.html#cb93-1" aria-hidden="true" tabindex="-1"></a>prox_wo_tree_filtering <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/proximity_values.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-2"><a href="id_04_candidate_antigen_clustering.html#cb93-2" aria-hidden="true" tabindex="-1"></a>prox_w_tree_filtering <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/proximity_values_tree_filtering.csv&quot;</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb93-3"><a href="id_04_candidate_antigen_clustering.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(prox_wo_tree_filtering) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(prox_wo_tree_filtering)</span>
<span id="cb93-4"><a href="id_04_candidate_antigen_clustering.html#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(prox_w_tree_filtering) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(prox_w_tree_filtering)</span>
<span id="cb93-5"><a href="id_04_candidate_antigen_clustering.html#cb93-5" aria-hidden="true" tabindex="-1"></a>dist_wo_tree_filtering <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prox_wo_tree_filtering</span>
<span id="cb93-6"><a href="id_04_candidate_antigen_clustering.html#cb93-6" aria-hidden="true" tabindex="-1"></a>dist_w_tree_filtering <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> prox_w_tree_filtering</span>
<span id="cb93-7"><a href="id_04_candidate_antigen_clustering.html#cb93-7" aria-hidden="true" tabindex="-1"></a>diff_dist <span class="ot">&lt;-</span> dist_w_tree_filtering <span class="sc">-</span> dist_wo_tree_filtering</span>
<span id="cb93-8"><a href="id_04_candidate_antigen_clustering.html#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb94-1"><a href="id_04_candidate_antigen_clustering.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSP, RH5, MSP5, P230</span></span>
<span id="cb94-2"><a href="id_04_candidate_antigen_clustering.html#cb94-2" aria-hidden="true" tabindex="-1"></a>ref <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>)</span>
<span id="cb94-3"><a href="id_04_candidate_antigen_clustering.html#cb94-3" aria-hidden="true" tabindex="-1"></a>dist_wo_tree_filtering[ref, ref]</span>
<span id="cb94-4"><a href="id_04_candidate_antigen_clustering.html#cb94-4" aria-hidden="true" tabindex="-1"></a>dist_w_tree_filtering[ref, ref]</span>
<span id="cb94-5"><a href="id_04_candidate_antigen_clustering.html#cb94-5" aria-hidden="true" tabindex="-1"></a>diff_dist[ref, ref]</span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb95-1"><a href="id_04_candidate_antigen_clustering.html#cb95-1" aria-hidden="true" tabindex="-1"></a>plot_boxplots <span class="ot">&lt;-</span> <span class="cf">function</span>(protein_id, protein_name, ylim1, ylim2) {</span>
<span id="cb95-2"><a href="id_04_candidate_antigen_clustering.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  dist_0 <span class="ot">&lt;-</span> dist_wo_tree_filtering[<span class="fu">c</span>(protein_id_1, protein_id_2, protein_id_3), protein_id]</span>
<span id="cb95-3"><a href="id_04_candidate_antigen_clustering.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  dist_1 <span class="ot">&lt;-</span> dist_w_tree_filtering[<span class="fu">c</span>(protein_id_1, protein_id_2, protein_id_3), protein_id]</span>
<span id="cb95-4"><a href="id_04_candidate_antigen_clustering.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  dist_smry <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb95-5"><a href="id_04_candidate_antigen_clustering.html#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">rep</span>(<span class="fu">c</span>(</span>
<span id="cb95-6"><a href="id_04_candidate_antigen_clustering.html#cb95-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="fu">length</span>(protein_id_1)),</span>
<span id="cb95-7"><a href="id_04_candidate_antigen_clustering.html#cb95-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 2&quot;</span>, <span class="fu">length</span>(protein_id_2)),</span>
<span id="cb95-8"><a href="id_04_candidate_antigen_clustering.html#cb95-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 3&quot;</span>, <span class="fu">length</span>(protein_id_3))</span>
<span id="cb95-9"><a href="id_04_candidate_antigen_clustering.html#cb95-9" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb95-10"><a href="id_04_candidate_antigen_clustering.html#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(dist_0, dist_1),</span>
<span id="cb95-11"><a href="id_04_candidate_antigen_clustering.html#cb95-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(dist_0)), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(dist_1))))</span>
<span id="cb95-12"><a href="id_04_candidate_antigen_clustering.html#cb95-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-13"><a href="id_04_candidate_antigen_clustering.html#cb95-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-14"><a href="id_04_candidate_antigen_clustering.html#cb95-14" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb95-15"><a href="id_04_candidate_antigen_clustering.html#cb95-15" aria-hidden="true" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb95-16"><a href="id_04_candidate_antigen_clustering.html#cb95-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb95-17"><a href="id_04_candidate_antigen_clustering.html#cb95-17" aria-hidden="true" tabindex="-1"></a>    ds_ <span class="ot">&lt;-</span> dist_smry[dist_smry<span class="sc">$</span>label <span class="sc">==</span> <span class="fu">paste0</span>(<span class="st">&quot;Group &quot;</span>, i), ]</span>
<span id="cb95-18"><a href="id_04_candidate_antigen_clustering.html#cb95-18" aria-hidden="true" tabindex="-1"></a>    ds_<span class="sc">$</span>paired <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(ds_) <span class="sc">/</span> <span class="dv">2</span>), <span class="dv">2</span>)</span>
<span id="cb95-19"><a href="id_04_candidate_antigen_clustering.html#cb95-19" aria-hidden="true" tabindex="-1"></a>    pval <span class="ot">&lt;-</span> <span class="fu">c</span>(pval, <span class="fu">compare_means</span>(value <span class="sc">~</span> variable,</span>
<span id="cb95-20"><a href="id_04_candidate_antigen_clustering.html#cb95-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> ds_, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>,</span>
<span id="cb95-21"><a href="id_04_candidate_antigen_clustering.html#cb95-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">paired =</span> <span class="cn">TRUE</span></span>
<span id="cb95-22"><a href="id_04_candidate_antigen_clustering.html#cb95-22" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">$</span>p)</span>
<span id="cb95-23"><a href="id_04_candidate_antigen_clustering.html#cb95-23" aria-hidden="true" tabindex="-1"></a>    ds <span class="ot">&lt;-</span> <span class="fu">list.append</span>(ds, ds_)</span>
<span id="cb95-24"><a href="id_04_candidate_antigen_clustering.html#cb95-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-25"><a href="id_04_candidate_antigen_clustering.html#cb95-25" aria-hidden="true" tabindex="-1"></a>  adj_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> <span class="fu">length</span>(pval))</span>
<span id="cb95-26"><a href="id_04_candidate_antigen_clustering.html#cb95-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-27"><a href="id_04_candidate_antigen_clustering.html#cb95-27" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb95-28"><a href="id_04_candidate_antigen_clustering.html#cb95-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb95-29"><a href="id_04_candidate_antigen_clustering.html#cb95-29" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds[[i]], <span class="fu">aes</span>(<span class="at">x =</span> variable, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb95-30"><a href="id_04_candidate_antigen_clustering.html#cb95-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey60&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-31"><a href="id_04_candidate_antigen_clustering.html#cb95-31" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable), <span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-32"><a href="id_04_candidate_antigen_clustering.html#cb95-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> paired), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-33"><a href="id_04_candidate_antigen_clustering.html#cb95-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> variable),</span>
<span id="cb95-34"><a href="id_04_candidate_antigen_clustering.html#cb95-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="dv">2</span>,</span>
<span id="cb95-35"><a href="id_04_candidate_antigen_clustering.html#cb95-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">priority =</span> <span class="st">&quot;random&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb95-36"><a href="id_04_candidate_antigen_clustering.html#cb95-36" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb95-37"><a href="id_04_candidate_antigen_clustering.html#cb95-37" aria-hidden="true" tabindex="-1"></a>      <span class="co"># annotate(&quot;segment&quot;, x=1, xend=2, y=max(ds[[i]]$value) + 0.04, yend=max(ds[[i]]$value) + 0.04,</span></span>
<span id="cb95-38"><a href="id_04_candidate_antigen_clustering.html#cb95-38" aria-hidden="true" tabindex="-1"></a>      <span class="co">#          colour=&quot;black&quot;) +</span></span>
<span id="cb95-39"><a href="id_04_candidate_antigen_clustering.html#cb95-39" aria-hidden="true" tabindex="-1"></a>      <span class="co"># annotate(&quot;segment&quot;, x=1, xend=1, y=max(ds[[i]]$value) + 0.04, yend=max(ds[[i]]$value) + 0.03,</span></span>
<span id="cb95-40"><a href="id_04_candidate_antigen_clustering.html#cb95-40" aria-hidden="true" tabindex="-1"></a>      <span class="co">#          colour=&quot;black&quot;) +</span></span>
<span id="cb95-41"><a href="id_04_candidate_antigen_clustering.html#cb95-41" aria-hidden="true" tabindex="-1"></a>      <span class="co"># annotate(&quot;segment&quot;, x=2, xend=2, y=max(ds[[i]]$value) + 0.04, yend=max(ds[[i]]$value) + 0.03,</span></span>
<span id="cb95-42"><a href="id_04_candidate_antigen_clustering.html#cb95-42" aria-hidden="true" tabindex="-1"></a>      <span class="co">#          colour=&quot;black&quot;) +</span></span>
<span id="cb95-43"><a href="id_04_candidate_antigen_clustering.html#cb95-43" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb95-44"><a href="id_04_candidate_antigen_clustering.html#cb95-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (adj_pval[i] <span class="sc">&gt;=</span> <span class="fl">1e-3</span>) {</span>
<span id="cb95-45"><a href="id_04_candidate_antigen_clustering.html#cb95-45" aria-hidden="true" tabindex="-1"></a>          <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb95-46"><a href="id_04_candidate_antigen_clustering.html#cb95-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fu">max</span>(ds[[i]]<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.06</span>,</span>
<span id="cb95-47"><a href="id_04_candidate_antigen_clustering.html#cb95-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, <span class="fu">round</span>(adj_pval[i], <span class="dv">3</span>))</span>
<span id="cb95-48"><a href="id_04_candidate_antigen_clustering.html#cb95-48" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-49"><a href="id_04_candidate_antigen_clustering.html#cb95-49" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb95-50"><a href="id_04_candidate_antigen_clustering.html#cb95-50" aria-hidden="true" tabindex="-1"></a>          <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>,</span>
<span id="cb95-51"><a href="id_04_candidate_antigen_clustering.html#cb95-51" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fu">max</span>(ds[[i]]<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.06</span>,</span>
<span id="cb95-52"><a href="id_04_candidate_antigen_clustering.html#cb95-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, <span class="fu">formatC</span>(adj_pval[i], <span class="at">format =</span> <span class="st">&quot;e&quot;</span>, <span class="at">digits =</span> <span class="dv">2</span>))</span>
<span id="cb95-53"><a href="id_04_candidate_antigen_clustering.html#cb95-53" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-54"><a href="id_04_candidate_antigen_clustering.html#cb95-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-55"><a href="id_04_candidate_antigen_clustering.html#cb95-55" aria-hidden="true" tabindex="-1"></a>      } <span class="sc">+</span></span>
<span id="cb95-56"><a href="id_04_candidate_antigen_clustering.html#cb95-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#f7d59e&quot;</span>, <span class="st">&quot;#fcd7d7&quot;</span>)) <span class="sc">+</span></span>
<span id="cb95-57"><a href="id_04_candidate_antigen_clustering.html#cb95-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_fill_manual</span>(</span>
<span id="cb95-58"><a href="id_04_candidate_antigen_clustering.html#cb95-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#fc9d03&quot;</span>, <span class="st">&quot;red&quot;</span>),</span>
<span id="cb95-59"><a href="id_04_candidate_antigen_clustering.html#cb95-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)</span>
<span id="cb95-60"><a href="id_04_candidate_antigen_clustering.html#cb95-60" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb95-61"><a href="id_04_candidate_antigen_clustering.html#cb95-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Without tree filtering&quot;</span>, <span class="st">&quot;With tree filtering&quot;</span>)) <span class="sc">+</span></span>
<span id="cb95-62"><a href="id_04_candidate_antigen_clustering.html#cb95-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-63"><a href="id_04_candidate_antigen_clustering.html#cb95-63" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb95-64"><a href="id_04_candidate_antigen_clustering.html#cb95-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb95-65"><a href="id_04_candidate_antigen_clustering.html#cb95-65" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(</span>
<span id="cb95-66"><a href="id_04_candidate_antigen_clustering.html#cb95-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-67"><a href="id_04_candidate_antigen_clustering.html#cb95-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-68"><a href="id_04_candidate_antigen_clustering.html#cb95-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">25</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb95-69"><a href="id_04_candidate_antigen_clustering.html#cb95-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-70"><a href="id_04_candidate_antigen_clustering.html#cb95-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb95-71"><a href="id_04_candidate_antigen_clustering.html#cb95-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-72"><a href="id_04_candidate_antigen_clustering.html#cb95-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-73"><a href="id_04_candidate_antigen_clustering.html#cb95-73" aria-hidden="true" tabindex="-1"></a>            <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb95-74"><a href="id_04_candidate_antigen_clustering.html#cb95-74" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb95-75"><a href="id_04_candidate_antigen_clustering.html#cb95-75" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-76"><a href="id_04_candidate_antigen_clustering.html#cb95-76" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb95-77"><a href="id_04_candidate_antigen_clustering.html#cb95-77" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(</span>
<span id="cb95-78"><a href="id_04_candidate_antigen_clustering.html#cb95-78" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-79"><a href="id_04_candidate_antigen_clustering.html#cb95-79" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-80"><a href="id_04_candidate_antigen_clustering.html#cb95-80" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb95-81"><a href="id_04_candidate_antigen_clustering.html#cb95-81" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-82"><a href="id_04_candidate_antigen_clustering.html#cb95-82" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb95-83"><a href="id_04_candidate_antigen_clustering.html#cb95-83" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-84"><a href="id_04_candidate_antigen_clustering.html#cb95-84" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-85"><a href="id_04_candidate_antigen_clustering.html#cb95-85" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-86"><a href="id_04_candidate_antigen_clustering.html#cb95-86" aria-hidden="true" tabindex="-1"></a>            <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb95-87"><a href="id_04_candidate_antigen_clustering.html#cb95-87" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb95-88"><a href="id_04_candidate_antigen_clustering.html#cb95-88" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-89"><a href="id_04_candidate_antigen_clustering.html#cb95-89" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb95-90"><a href="id_04_candidate_antigen_clustering.html#cb95-90" aria-hidden="true" tabindex="-1"></a>          <span class="fu">theme</span>(</span>
<span id="cb95-91"><a href="id_04_candidate_antigen_clustering.html#cb95-91" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-92"><a href="id_04_candidate_antigen_clustering.html#cb95-92" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-93"><a href="id_04_candidate_antigen_clustering.html#cb95-93" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb95-94"><a href="id_04_candidate_antigen_clustering.html#cb95-94" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-95"><a href="id_04_candidate_antigen_clustering.html#cb95-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb95-96"><a href="id_04_candidate_antigen_clustering.html#cb95-96" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-97"><a href="id_04_candidate_antigen_clustering.html#cb95-97" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-98"><a href="id_04_candidate_antigen_clustering.html#cb95-98" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-99"><a href="id_04_candidate_antigen_clustering.html#cb95-99" aria-hidden="true" tabindex="-1"></a>            <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb95-100"><a href="id_04_candidate_antigen_clustering.html#cb95-100" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb95-101"><a href="id_04_candidate_antigen_clustering.html#cb95-101" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb95-102"><a href="id_04_candidate_antigen_clustering.html#cb95-102" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-103"><a href="id_04_candidate_antigen_clustering.html#cb95-103" aria-hidden="true" tabindex="-1"></a>      } <span class="sc">+</span></span>
<span id="cb95-104"><a href="id_04_candidate_antigen_clustering.html#cb95-104" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-105"><a href="id_04_candidate_antigen_clustering.html#cb95-105" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb95-106"><a href="id_04_candidate_antigen_clustering.html#cb95-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb95-107"><a href="id_04_candidate_antigen_clustering.html#cb95-107" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="fu">paste0</span>(<span class="st">&quot;Euclidean distance to &quot;</span>, protein_name))</span>
<span id="cb95-108"><a href="id_04_candidate_antigen_clustering.html#cb95-108" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb95-109"><a href="id_04_candidate_antigen_clustering.html#cb95-109" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ylab</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb95-110"><a href="id_04_candidate_antigen_clustering.html#cb95-110" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb95-111"><a href="id_04_candidate_antigen_clustering.html#cb95-111" aria-hidden="true" tabindex="-1"></a>      } <span class="sc">+</span></span>
<span id="cb95-112"><a href="id_04_candidate_antigen_clustering.html#cb95-112" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(ylim1) <span class="sc">+</span></span>
<span id="cb95-113"><a href="id_04_candidate_antigen_clustering.html#cb95-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">&quot;Group &quot;</span>, i))</span>
<span id="cb95-114"><a href="id_04_candidate_antigen_clustering.html#cb95-114" aria-hidden="true" tabindex="-1"></a>    plots <span class="ot">&lt;-</span> <span class="fu">list.append</span>(plots, p)</span>
<span id="cb95-115"><a href="id_04_candidate_antigen_clustering.html#cb95-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-116"><a href="id_04_candidate_antigen_clustering.html#cb95-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-117"><a href="id_04_candidate_antigen_clustering.html#cb95-117" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot difference</span></span>
<span id="cb95-118"><a href="id_04_candidate_antigen_clustering.html#cb95-118" aria-hidden="true" tabindex="-1"></a>  diff_grps <span class="ot">&lt;-</span> diff_dist[<span class="fu">c</span>(protein_id_1, protein_id_2, protein_id_3), protein_id]</span>
<span id="cb95-119"><a href="id_04_candidate_antigen_clustering.html#cb95-119" aria-hidden="true" tabindex="-1"></a>  ds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb95-120"><a href="id_04_candidate_antigen_clustering.html#cb95-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">c</span>(diff_grps),</span>
<span id="cb95-121"><a href="id_04_candidate_antigen_clustering.html#cb95-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">c</span>(</span>
<span id="cb95-122"><a href="id_04_candidate_antigen_clustering.html#cb95-122" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="fu">length</span>(protein_id_1)),</span>
<span id="cb95-123"><a href="id_04_candidate_antigen_clustering.html#cb95-123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 2&quot;</span>, <span class="fu">length</span>(protein_id_2)),</span>
<span id="cb95-124"><a href="id_04_candidate_antigen_clustering.html#cb95-124" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;Group 3&quot;</span>, <span class="fu">length</span>(protein_id_3))</span>
<span id="cb95-125"><a href="id_04_candidate_antigen_clustering.html#cb95-125" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb95-126"><a href="id_04_candidate_antigen_clustering.html#cb95-126" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb95-127"><a href="id_04_candidate_antigen_clustering.html#cb95-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-128"><a href="id_04_candidate_antigen_clustering.html#cb95-128" aria-hidden="true" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">compare_means</span>(value <span class="sc">~</span> group, <span class="at">data =</span> ds, <span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">p.adjust.method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb95-129"><a href="id_04_candidate_antigen_clustering.html#cb95-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-130"><a href="id_04_candidate_antigen_clustering.html#cb95-130" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> ds, <span class="fu">aes</span>(<span class="at">x =</span> group, <span class="at">y =</span> value, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb95-131"><a href="id_04_candidate_antigen_clustering.html#cb95-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-132"><a href="id_04_candidate_antigen_clustering.html#cb95-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb95-133"><a href="id_04_candidate_antigen_clustering.html#cb95-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_beeswarm</span>(<span class="fu">aes</span>(<span class="at">fill =</span> group),</span>
<span id="cb95-134"><a href="id_04_candidate_antigen_clustering.html#cb95-134" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">cex =</span> <span class="fl">1.5</span>,</span>
<span id="cb95-135"><a href="id_04_candidate_antigen_clustering.html#cb95-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">priority =</span> <span class="st">&quot;random&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb95-136"><a href="id_04_candidate_antigen_clustering.html#cb95-136" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-137"><a href="id_04_candidate_antigen_clustering.html#cb95-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="fl">1.95</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-138"><a href="id_04_candidate_antigen_clustering.html#cb95-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.002</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-139"><a href="id_04_candidate_antigen_clustering.html#cb95-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">1.95</span>, <span class="at">xend =</span> <span class="fl">1.95</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.002</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-140"><a href="id_04_candidate_antigen_clustering.html#cb95-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.007</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, stats<span class="sc">$</span>p.adj[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb95-141"><a href="id_04_candidate_antigen_clustering.html#cb95-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-142"><a href="id_04_candidate_antigen_clustering.html#cb95-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.008</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-143"><a href="id_04_candidate_antigen_clustering.html#cb95-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.008</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.01</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-144"><a href="id_04_candidate_antigen_clustering.html#cb95-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.013</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, stats<span class="sc">$</span>p.adj[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb95-145"><a href="id_04_candidate_antigen_clustering.html#cb95-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">2.05</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-146"><a href="id_04_candidate_antigen_clustering.html#cb95-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="fl">2.05</span>, <span class="at">xend =</span> <span class="fl">2.05</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.002</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-147"><a href="id_04_candidate_antigen_clustering.html#cb95-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;segment&quot;</span>, <span class="at">x =</span> <span class="dv">3</span>, <span class="at">xend =</span> <span class="dv">3</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.002</span>, <span class="at">yend =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.004</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-148"><a href="id_04_candidate_antigen_clustering.html#cb95-148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> <span class="fu">max</span>(ds<span class="sc">$</span>value) <span class="sc">+</span> <span class="fl">0.007</span>, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;p = &quot;</span>, stats<span class="sc">$</span>p.adj[<span class="dv">3</span>])) <span class="sc">+</span></span>
<span id="cb95-149"><a href="id_04_candidate_antigen_clustering.html#cb95-149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb95-150"><a href="id_04_candidate_antigen_clustering.html#cb95-150" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Group 1&quot;</span>, <span class="st">&quot;Group 2&quot;</span>, <span class="st">&quot;Group 3&quot;</span>),</span>
<span id="cb95-151"><a href="id_04_candidate_antigen_clustering.html#cb95-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#03a1fc&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#FF7F00&quot;</span>),</span>
<span id="cb95-152"><a href="id_04_candidate_antigen_clustering.html#cb95-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb95-153"><a href="id_04_candidate_antigen_clustering.html#cb95-153" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Candidate antigen (Group 1)&quot;</span>,</span>
<span id="cb95-154"><a href="id_04_candidate_antigen_clustering.html#cb95-154" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Candidate antigen (Group 2)&quot;</span>,</span>
<span id="cb95-155"><a href="id_04_candidate_antigen_clustering.html#cb95-155" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;Candidate antigen (Group 3)&quot;</span></span>
<span id="cb95-156"><a href="id_04_candidate_antigen_clustering.html#cb95-156" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb95-157"><a href="id_04_candidate_antigen_clustering.html#cb95-157" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-158"><a href="id_04_candidate_antigen_clustering.html#cb95-158" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb95-159"><a href="id_04_candidate_antigen_clustering.html#cb95-159" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb95-160"><a href="id_04_candidate_antigen_clustering.html#cb95-160" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-161"><a href="id_04_candidate_antigen_clustering.html#cb95-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb95-162"><a href="id_04_candidate_antigen_clustering.html#cb95-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">38</span>, <span class="dv">15</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb95-163"><a href="id_04_candidate_antigen_clustering.html#cb95-163" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-164"><a href="id_04_candidate_antigen_clustering.html#cb95-164" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb95-165"><a href="id_04_candidate_antigen_clustering.html#cb95-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-166"><a href="id_04_candidate_antigen_clustering.html#cb95-166" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb95-167"><a href="id_04_candidate_antigen_clustering.html#cb95-167" aria-hidden="true" tabindex="-1"></a>      <span class="at">rect =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb95-168"><a href="id_04_candidate_antigen_clustering.html#cb95-168" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb95-169"><a href="id_04_candidate_antigen_clustering.html#cb95-169" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb95-170"><a href="id_04_candidate_antigen_clustering.html#cb95-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb95-171"><a href="id_04_candidate_antigen_clustering.html#cb95-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="fu">paste0</span>(<span class="st">&quot;Difference in distances to &quot;</span>, protein_name)) <span class="sc">+</span></span>
<span id="cb95-172"><a href="id_04_candidate_antigen_clustering.html#cb95-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylim</span>(ylim2) <span class="sc">+</span></span>
<span id="cb95-173"><a href="id_04_candidate_antigen_clustering.html#cb95-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb95-174"><a href="id_04_candidate_antigen_clustering.html#cb95-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-175"><a href="id_04_candidate_antigen_clustering.html#cb95-175" aria-hidden="true" tabindex="-1"></a>  plots <span class="ot">&lt;-</span> <span class="fu">list.append</span>(plots, p)</span>
<span id="cb95-176"><a href="id_04_candidate_antigen_clustering.html#cb95-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-177"><a href="id_04_candidate_antigen_clustering.html#cb95-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plots)</span>
<span id="cb95-178"><a href="id_04_candidate_antigen_clustering.html#cb95-178" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb96-1"><a href="id_04_candidate_antigen_clustering.html#cb96-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">&quot;CSP (circumsporozoite protein); pre-erythrocytic stage&quot;</span>),</span>
<span id="cb96-2"><a href="id_04_candidate_antigen_clustering.html#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb96-3"><a href="id_04_candidate_antigen_clustering.html#cb96-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotlist =</span> <span class="fu">plot_boxplots</span>(</span>
<span id="cb96-4"><a href="id_04_candidate_antigen_clustering.html#cb96-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">protein_id =</span> <span class="st">&quot;PF3D7_0304600.1-p1&quot;</span>, <span class="at">protein_name =</span> <span class="st">&quot;CSP&quot;</span>,</span>
<span id="cb96-5"><a href="id_04_candidate_antigen_clustering.html#cb96-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim1 =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">ylim2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb96-6"><a href="id_04_candidate_antigen_clustering.html#cb96-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb96-7"><a href="id_04_candidate_antigen_clustering.html#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.29</span>, <span class="fl">0.22</span>, <span class="fl">0.23</span>, <span class="fl">0.48</span>)</span>
<span id="cb96-8"><a href="id_04_candidate_antigen_clustering.html#cb96-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb96-9"><a href="id_04_candidate_antigen_clustering.html#cb96-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb96-10"><a href="id_04_candidate_antigen_clustering.html#cb96-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-11"><a href="id_04_candidate_antigen_clustering.html#cb96-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">&quot;RH5 (reticulocyte binding protein homologue 5); erythrocytic stage&quot;</span>),</span>
<span id="cb96-12"><a href="id_04_candidate_antigen_clustering.html#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb96-13"><a href="id_04_candidate_antigen_clustering.html#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotlist =</span> <span class="fu">plot_boxplots</span>(</span>
<span id="cb96-14"><a href="id_04_candidate_antigen_clustering.html#cb96-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">protein_id =</span> <span class="st">&quot;PF3D7_0424100.1-p1&quot;</span>, <span class="at">protein_name =</span> <span class="st">&quot;RH5&quot;</span>,</span>
<span id="cb96-15"><a href="id_04_candidate_antigen_clustering.html#cb96-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim1 =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">ylim2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb96-16"><a href="id_04_candidate_antigen_clustering.html#cb96-16" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb96-17"><a href="id_04_candidate_antigen_clustering.html#cb96-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.29</span>, <span class="fl">0.22</span>, <span class="fl">0.23</span>, <span class="fl">0.48</span>)</span>
<span id="cb96-18"><a href="id_04_candidate_antigen_clustering.html#cb96-18" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb96-19"><a href="id_04_candidate_antigen_clustering.html#cb96-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb96-20"><a href="id_04_candidate_antigen_clustering.html#cb96-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-21"><a href="id_04_candidate_antigen_clustering.html#cb96-21" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">&quot;MSP5 (merozoite surface protein 5); erythrocytic stage&quot;</span>),</span>
<span id="cb96-22"><a href="id_04_candidate_antigen_clustering.html#cb96-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb96-23"><a href="id_04_candidate_antigen_clustering.html#cb96-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotlist =</span> <span class="fu">plot_boxplots</span>(</span>
<span id="cb96-24"><a href="id_04_candidate_antigen_clustering.html#cb96-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">protein_id =</span> <span class="st">&quot;PF3D7_0206900.1-p1&quot;</span>, <span class="at">protein_name =</span> <span class="st">&quot;MSP5&quot;</span>,</span>
<span id="cb96-25"><a href="id_04_candidate_antigen_clustering.html#cb96-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim1 =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">ylim2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb96-26"><a href="id_04_candidate_antigen_clustering.html#cb96-26" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb96-27"><a href="id_04_candidate_antigen_clustering.html#cb96-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.29</span>, <span class="fl">0.22</span>, <span class="fl">0.23</span>, <span class="fl">0.48</span>)</span>
<span id="cb96-28"><a href="id_04_candidate_antigen_clustering.html#cb96-28" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb96-29"><a href="id_04_candidate_antigen_clustering.html#cb96-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb96-30"><a href="id_04_candidate_antigen_clustering.html#cb96-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb96-31"><a href="id_04_candidate_antigen_clustering.html#cb96-31" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="fu">ggdraw</span>() <span class="sc">+</span> <span class="fu">draw_label</span>(<span class="st">&quot;P230 (6-cysteine protein); gametocyte stage&quot;</span>),</span>
<span id="cb96-32"><a href="id_04_candidate_antigen_clustering.html#cb96-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(</span>
<span id="cb96-33"><a href="id_04_candidate_antigen_clustering.html#cb96-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">plotlist =</span> <span class="fu">plot_boxplots</span>(</span>
<span id="cb96-34"><a href="id_04_candidate_antigen_clustering.html#cb96-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">protein_id =</span> <span class="st">&quot;PF3D7_0209000.1-p1&quot;</span>, <span class="at">protein_name =</span> <span class="st">&quot;P230&quot;</span>,</span>
<span id="cb96-35"><a href="id_04_candidate_antigen_clustering.html#cb96-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim1 =</span> <span class="fu">c</span>(<span class="fl">0.15</span>, <span class="fl">0.7</span>), <span class="at">ylim2 =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.03</span>, <span class="fl">0.04</span>)</span>
<span id="cb96-36"><a href="id_04_candidate_antigen_clustering.html#cb96-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb96-37"><a href="id_04_candidate_antigen_clustering.html#cb96-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.29</span>, <span class="fl">0.22</span>, <span class="fl">0.23</span>, <span class="fl">0.48</span>)</span>
<span id="cb96-38"><a href="id_04_candidate_antigen_clustering.html#cb96-38" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb96-39"><a href="id_04_candidate_antigen_clustering.html#cb96-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;d&quot;</span>, <span class="st">&quot;&quot;</span>)</span>
<span id="cb96-40"><a href="id_04_candidate_antigen_clustering.html#cb96-40" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><strong>Final plot</strong></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb97-1"><a href="id_04_candidate_antigen_clustering.html#cb97-1" aria-hidden="true" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(p1, p2, p3, p4, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb97-2"><a href="id_04_candidate_antigen_clustering.html#cb97-2" aria-hidden="true" tabindex="-1"></a>p_combined</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%209.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="important-variables-for-candidate-clustering-groups" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Important variables for candidate clustering groups<a href="id_04_candidate_antigen_clustering.html#important-variables-for-candidate-clustering-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Wilcox test to compare variable values in candidate groups and randomly selected proteins.</p>
<div id="analysis-6" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Analysis<a href="id_04_candidate_antigen_clustering.html#analysis-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Permutation-based variable importance of candidate antigen groups.</p>
<div id="variable-importance-2" class="section level4 hasAnchor" number="4.3.1.1">
<h4><span class="header-section-number">4.3.1.1</span> Variable importance<a href="id_04_candidate_antigen_clustering.html#variable-importance-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb98-1"><a href="id_04_candidate_antigen_clustering.html#cb98-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_ml_input_processed_weighted.csv&quot;</span>)</span>
<span id="cb98-2"><a href="id_04_candidate_antigen_clustering.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span>
<span id="cb98-3"><a href="id_04_candidate_antigen_clustering.html#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="id_04_candidate_antigen_clustering.html#cb98-4" aria-hidden="true" tabindex="-1"></a>data_1 <span class="ot">&lt;-</span> data</span>
<span id="cb98-5"><a href="id_04_candidate_antigen_clustering.html#cb98-5" aria-hidden="true" tabindex="-1"></a>data_1<span class="sc">$</span>antigen_label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-6"><a href="id_04_candidate_antigen_clustering.html#cb98-6" aria-hidden="true" tabindex="-1"></a>data_1<span class="sc">$</span>antigen_label[data_1<span class="sc">$</span>X <span class="sc">%in%</span> protein_id_1] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-7"><a href="id_04_candidate_antigen_clustering.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_1, <span class="st">&quot;./other_data/pf_ml_input_processed_weighted_group_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-8"><a href="id_04_candidate_antigen_clustering.html#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="id_04_candidate_antigen_clustering.html#cb98-9" aria-hidden="true" tabindex="-1"></a>data_2 <span class="ot">&lt;-</span> data</span>
<span id="cb98-10"><a href="id_04_candidate_antigen_clustering.html#cb98-10" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>antigen_label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-11"><a href="id_04_candidate_antigen_clustering.html#cb98-11" aria-hidden="true" tabindex="-1"></a>data_2<span class="sc">$</span>antigen_label[data_2<span class="sc">$</span>X <span class="sc">%in%</span> protein_id_2] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-12"><a href="id_04_candidate_antigen_clustering.html#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_2, <span class="st">&quot;./other_data/pf_ml_input_processed_weighted_group_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb98-13"><a href="id_04_candidate_antigen_clustering.html#cb98-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-14"><a href="id_04_candidate_antigen_clustering.html#cb98-14" aria-hidden="true" tabindex="-1"></a>data_3 <span class="ot">&lt;-</span> data</span>
<span id="cb98-15"><a href="id_04_candidate_antigen_clustering.html#cb98-15" aria-hidden="true" tabindex="-1"></a>data_3<span class="sc">$</span>antigen_label <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-16"><a href="id_04_candidate_antigen_clustering.html#cb98-16" aria-hidden="true" tabindex="-1"></a>data_3<span class="sc">$</span>antigen_label[data_3<span class="sc">$</span>X <span class="sc">%in%</span> protein_id_3] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-17"><a href="id_04_candidate_antigen_clustering.html#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(data_3, <span class="st">&quot;./other_data/pf_ml_input_processed_weighted_group_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><strong>In Python: </strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb99-1"><a href="id_04_candidate_antigen_clustering.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb99-2"><a href="id_04_candidate_antigen_clustering.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb99-3"><a href="id_04_candidate_antigen_clustering.html#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb99-4"><a href="id_04_candidate_antigen_clustering.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pickle</span>
<span id="cb99-5"><a href="id_04_candidate_antigen_clustering.html#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb99-6"><a href="id_04_candidate_antigen_clustering.html#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb99-7"><a href="id_04_candidate_antigen_clustering.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial <span class="im">import</span> distance</span>
<span id="cb99-8"><a href="id_04_candidate_antigen_clustering.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> multiprocessing</span>
<span id="cb99-9"><a href="id_04_candidate_antigen_clustering.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> joblib <span class="im">import</span> Parallel, delayed</span>
<span id="cb99-10"><a href="id_04_candidate_antigen_clustering.html#cb99-10" aria-hidden="true" tabindex="-1"></a>num_cores <span class="op">=</span> multiprocessing.cpu_count()</span>
<span id="cb99-11"><a href="id_04_candidate_antigen_clustering.html#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble._forest <span class="im">import</span> _generate_unsampled_indices</span>
<span id="cb99-12"><a href="id_04_candidate_antigen_clustering.html#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> session_info</span></code></pre></div>
<div class="sourceCode" id="cb100"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb100-1"><a href="id_04_candidate_antigen_clustering.html#cb100-1" aria-hidden="true" tabindex="-1"></a>data_1 <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/pf_ml_input_processed_weighted_group_1.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb100-2"><a href="id_04_candidate_antigen_clustering.html#cb100-2" aria-hidden="true" tabindex="-1"></a>pf3d7_features_processed_1 <span class="op">=</span> data_1.iloc[:,<span class="dv">1</span>:].<span class="bu">apply</span>(pd.to_numeric, downcast<span class="op">=</span><span class="st">&#39;float&#39;</span>)</span>
<span id="cb100-3"><a href="id_04_candidate_antigen_clustering.html#cb100-3" aria-hidden="true" tabindex="-1"></a>pf3d7_outcome_1 <span class="op">=</span> np.array(data_1.antigen_label)</span>
<span id="cb100-4"><a href="id_04_candidate_antigen_clustering.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="id_04_candidate_antigen_clustering.html#cb100-5" aria-hidden="true" tabindex="-1"></a>data_2 <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/pf_ml_input_processed_weighted_group_2.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb100-6"><a href="id_04_candidate_antigen_clustering.html#cb100-6" aria-hidden="true" tabindex="-1"></a>pf3d7_features_processed_2 <span class="op">=</span> data_2.iloc[:,<span class="dv">1</span>:].<span class="bu">apply</span>(pd.to_numeric, downcast<span class="op">=</span><span class="st">&#39;float&#39;</span>)</span>
<span id="cb100-7"><a href="id_04_candidate_antigen_clustering.html#cb100-7" aria-hidden="true" tabindex="-1"></a>pf3d7_outcome_2 <span class="op">=</span> np.array(data_2.antigen_label)</span>
<span id="cb100-8"><a href="id_04_candidate_antigen_clustering.html#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="id_04_candidate_antigen_clustering.html#cb100-9" aria-hidden="true" tabindex="-1"></a>data_3 <span class="op">=</span> pd.read_csv(<span class="st">&#39;./other_data/pf_ml_input_processed_weighted_group_3.csv&#39;</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb100-10"><a href="id_04_candidate_antigen_clustering.html#cb100-10" aria-hidden="true" tabindex="-1"></a>pf3d7_features_processed_3 <span class="op">=</span> data_3.iloc[:,<span class="dv">1</span>:].<span class="bu">apply</span>(pd.to_numeric, downcast<span class="op">=</span><span class="st">&#39;float&#39;</span>)</span>
<span id="cb100-11"><a href="id_04_candidate_antigen_clustering.html#cb100-11" aria-hidden="true" tabindex="-1"></a>pf3d7_outcome_3 <span class="op">=</span> np.array(data_3.antigen_label)</span>
<span id="cb100-12"><a href="id_04_candidate_antigen_clustering.html#cb100-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-13"><a href="id_04_candidate_antigen_clustering.html#cb100-13" aria-hidden="true" tabindex="-1"></a>purf_model <span class="op">=</span> pickle.load(<span class="bu">open</span>(<span class="st">&#39;./pickle_data/pf_purf_tree_filtering.pkl&#39;</span>, <span class="st">&#39;rb&#39;</span>))</span>
<span id="cb100-14"><a href="id_04_candidate_antigen_clustering.html#cb100-14" aria-hidden="true" tabindex="-1"></a>purf <span class="op">=</span> purf_model[<span class="st">&#39;model&#39;</span>]</span>
<span id="cb100-15"><a href="id_04_candidate_antigen_clustering.html#cb100-15" aria-hidden="true" tabindex="-1"></a>weights <span class="op">=</span> purf_model[<span class="st">&#39;weights&#39;</span>]</span>
<span id="cb100-16"><a href="id_04_candidate_antigen_clustering.html#cb100-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-17"><a href="id_04_candidate_antigen_clustering.html#cb100-17" aria-hidden="true" tabindex="-1"></a>metadata <span class="op">=</span> pd.read_csv(<span class="st">&#39;./data/supplementary_data_2_pf_protein_variable_metadata.csv&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb101-1"><a href="id_04_candidate_antigen_clustering.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_raw_var_imp_(idx, tree, X, y, weight, groups<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb101-2"><a href="id_04_candidate_antigen_clustering.html#cb101-2" aria-hidden="true" tabindex="-1"></a>    rng <span class="op">=</span> np.random.RandomState(idx)</span>
<span id="cb101-3"><a href="id_04_candidate_antigen_clustering.html#cb101-3" aria-hidden="true" tabindex="-1"></a>    oob_indices <span class="op">=</span> _generate_unsampled_indices(tree.random_state, y.shape[<span class="dv">0</span>], y.shape[<span class="dv">0</span>])</span>
<span id="cb101-4"><a href="id_04_candidate_antigen_clustering.html#cb101-4" aria-hidden="true" tabindex="-1"></a>    oob_pos <span class="op">=</span> np.intersect1d(oob_indices, np.where(y <span class="op">==</span> <span class="dv">1</span>)[<span class="dv">0</span>])</span>
<span id="cb101-5"><a href="id_04_candidate_antigen_clustering.html#cb101-5" aria-hidden="true" tabindex="-1"></a>    noutall <span class="op">=</span> <span class="bu">len</span>(oob_pos)</span>
<span id="cb101-6"><a href="id_04_candidate_antigen_clustering.html#cb101-6" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> tree.predict_proba(X.iloc[oob_pos,:])[:, <span class="dv">1</span>]</span>
<span id="cb101-7"><a href="id_04_candidate_antigen_clustering.html#cb101-7" aria-hidden="true" tabindex="-1"></a>    nrightall <span class="op">=</span> <span class="bu">sum</span>(pred <span class="op">==</span> y[oob_pos])</span>
<span id="cb101-8"><a href="id_04_candidate_antigen_clustering.html#cb101-8" aria-hidden="true" tabindex="-1"></a>    imprt, impsd <span class="op">=</span> [], []</span>
<span id="cb101-9"><a href="id_04_candidate_antigen_clustering.html#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> groups <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb101-10"><a href="id_04_candidate_antigen_clustering.html#cb101-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> var <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb101-11"><a href="id_04_candidate_antigen_clustering.html#cb101-11" aria-hidden="true" tabindex="-1"></a>            X_temp <span class="op">=</span> X.copy().iloc[oob_pos,:]</span>
<span id="cb101-12"><a href="id_04_candidate_antigen_clustering.html#cb101-12" aria-hidden="true" tabindex="-1"></a>            X_temp.iloc[:, var] <span class="op">=</span> rng.permutation(X_temp.iloc[:, var])</span>
<span id="cb101-13"><a href="id_04_candidate_antigen_clustering.html#cb101-13" aria-hidden="true" tabindex="-1"></a>            pred <span class="op">=</span> tree.predict_proba(X_temp)[:, <span class="dv">1</span>]</span>
<span id="cb101-14"><a href="id_04_candidate_antigen_clustering.html#cb101-14" aria-hidden="true" tabindex="-1"></a>            nrightimpall <span class="op">=</span> <span class="bu">sum</span>(pred <span class="op">==</span> y[oob_pos])</span>
<span id="cb101-15"><a href="id_04_candidate_antigen_clustering.html#cb101-15" aria-hidden="true" tabindex="-1"></a>            delta <span class="op">=</span> (nrightall <span class="op">-</span> nrightimpall) <span class="op">/</span> noutall <span class="op">*</span> weight</span>
<span id="cb101-16"><a href="id_04_candidate_antigen_clustering.html#cb101-16" aria-hidden="true" tabindex="-1"></a>            imprt.append(delta)</span>
<span id="cb101-17"><a href="id_04_candidate_antigen_clustering.html#cb101-17" aria-hidden="true" tabindex="-1"></a>            impsd.append(delta <span class="op">*</span> delta)</span>
<span id="cb101-18"><a href="id_04_candidate_antigen_clustering.html#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb101-19"><a href="id_04_candidate_antigen_clustering.html#cb101-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> grp <span class="kw">in</span> np.unique(groups):</span>
<span id="cb101-20"><a href="id_04_candidate_antigen_clustering.html#cb101-20" aria-hidden="true" tabindex="-1"></a>            X_temp <span class="op">=</span> X.copy().iloc[oob_pos,:]</span>
<span id="cb101-21"><a href="id_04_candidate_antigen_clustering.html#cb101-21" aria-hidden="true" tabindex="-1"></a>            X_temp.iloc[:, groups <span class="op">==</span> grp] <span class="op">=</span> rng.permutation(X_temp.iloc[:, groups <span class="op">==</span> grp])</span>
<span id="cb101-22"><a href="id_04_candidate_antigen_clustering.html#cb101-22" aria-hidden="true" tabindex="-1"></a>            pred <span class="op">=</span> tree.predict_proba(X_temp)[:, <span class="dv">1</span>]</span>
<span id="cb101-23"><a href="id_04_candidate_antigen_clustering.html#cb101-23" aria-hidden="true" tabindex="-1"></a>            nrightimpall <span class="op">=</span> <span class="bu">sum</span>(pred <span class="op">==</span> y[oob_pos])</span>
<span id="cb101-24"><a href="id_04_candidate_antigen_clustering.html#cb101-24" aria-hidden="true" tabindex="-1"></a>            delta <span class="op">=</span> (nrightall <span class="op">-</span> nrightimpall) <span class="op">/</span> noutall <span class="op">*</span> weight</span>
<span id="cb101-25"><a href="id_04_candidate_antigen_clustering.html#cb101-25" aria-hidden="true" tabindex="-1"></a>            imprt.append(delta)</span>
<span id="cb101-26"><a href="id_04_candidate_antigen_clustering.html#cb101-26" aria-hidden="true" tabindex="-1"></a>            impsd.append(delta <span class="op">*</span> delta)</span>
<span id="cb101-27"><a href="id_04_candidate_antigen_clustering.html#cb101-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (imprt, impsd)</span>
<span id="cb101-28"><a href="id_04_candidate_antigen_clustering.html#cb101-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb101-29"><a href="id_04_candidate_antigen_clustering.html#cb101-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_var_imp(model, features, outcome, num_cores, weights<span class="op">=</span><span class="va">None</span>, groups<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb101-30"><a href="id_04_candidate_antigen_clustering.html#cb101-30" aria-hidden="true" tabindex="-1"></a>    trees <span class="op">=</span> model.estimators_</span>
<span id="cb101-31"><a href="id_04_candidate_antigen_clustering.html#cb101-31" aria-hidden="true" tabindex="-1"></a>    idx_list <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(trees))]</span>
<span id="cb101-32"><a href="id_04_candidate_antigen_clustering.html#cb101-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> weights <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb101-33"><a href="id_04_candidate_antigen_clustering.html#cb101-33" aria-hidden="true" tabindex="-1"></a>        weights <span class="op">=</span> np.ones(<span class="bu">len</span>(trees))</span>
<span id="cb101-34"><a href="id_04_candidate_antigen_clustering.html#cb101-34" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> Parallel(n_jobs<span class="op">=</span>num_cores)(</span>
<span id="cb101-35"><a href="id_04_candidate_antigen_clustering.html#cb101-35" aria-hidden="true" tabindex="-1"></a>      delayed(calculate_raw_var_imp_)(idx, trees[idx], features, outcome, weights[idx], groups) <span class="cf">for</span> idx <span class="kw">in</span> idx_list)</span>
<span id="cb101-36"><a href="id_04_candidate_antigen_clustering.html#cb101-36" aria-hidden="true" tabindex="-1"></a>    imprt, impsd <span class="op">=</span> [], []</span>
<span id="cb101-37"><a href="id_04_candidate_antigen_clustering.html#cb101-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(idx_list)):</span>
<span id="cb101-38"><a href="id_04_candidate_antigen_clustering.html#cb101-38" aria-hidden="true" tabindex="-1"></a>        imprt.append(res[i][<span class="dv">0</span>])</span>
<span id="cb101-39"><a href="id_04_candidate_antigen_clustering.html#cb101-39" aria-hidden="true" tabindex="-1"></a>        impsd.append(res[i][<span class="dv">1</span>])</span>
<span id="cb101-40"><a href="id_04_candidate_antigen_clustering.html#cb101-40" aria-hidden="true" tabindex="-1"></a>    imprt <span class="op">=</span> np.array(imprt).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb101-41"><a href="id_04_candidate_antigen_clustering.html#cb101-41" aria-hidden="true" tabindex="-1"></a>    impsd <span class="op">=</span> np.array(impsd).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb101-42"><a href="id_04_candidate_antigen_clustering.html#cb101-42" aria-hidden="true" tabindex="-1"></a>    imprt <span class="op">/=</span> <span class="bu">len</span>(idx_list)</span>
<span id="cb101-43"><a href="id_04_candidate_antigen_clustering.html#cb101-43" aria-hidden="true" tabindex="-1"></a>    impsd <span class="op">=</span> np.sqrt(((impsd <span class="op">/</span> <span class="bu">len</span>(idx_list)) <span class="op">-</span> imprt <span class="op">*</span> imprt) <span class="op">/</span> <span class="bu">len</span>(idx_list))</span>
<span id="cb101-44"><a href="id_04_candidate_antigen_clustering.html#cb101-44" aria-hidden="true" tabindex="-1"></a>    mda <span class="op">=</span> []</span>
<span id="cb101-45"><a href="id_04_candidate_antigen_clustering.html#cb101-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(imprt)):</span>
<span id="cb101-46"><a href="id_04_candidate_antigen_clustering.html#cb101-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> impsd[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb101-47"><a href="id_04_candidate_antigen_clustering.html#cb101-47" aria-hidden="true" tabindex="-1"></a>            mda.append(imprt[i] <span class="op">/</span> impsd[i])</span>
<span id="cb101-48"><a href="id_04_candidate_antigen_clustering.html#cb101-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb101-49"><a href="id_04_candidate_antigen_clustering.html#cb101-49" aria-hidden="true" tabindex="-1"></a>            mda.append(imprt[i])</span>
<span id="cb101-50"><a href="id_04_candidate_antigen_clustering.html#cb101-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> groups <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb101-51"><a href="id_04_candidate_antigen_clustering.html#cb101-51" aria-hidden="true" tabindex="-1"></a>        var_imp <span class="op">=</span> pd.DataFrame({<span class="st">&#39;variable&#39;</span>: features.columns, <span class="st">&#39;meanDecreaseAccuracy&#39;</span>: mda})</span>
<span id="cb101-52"><a href="id_04_candidate_antigen_clustering.html#cb101-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>: </span>
<span id="cb101-53"><a href="id_04_candidate_antigen_clustering.html#cb101-53" aria-hidden="true" tabindex="-1"></a>        var_imp <span class="op">=</span> pd.DataFrame({<span class="st">&#39;variable&#39;</span>: np.unique(groups), <span class="st">&#39;meanDecreaseAccuracy&#39;</span>: mda})</span>
<span id="cb101-54"><a href="id_04_candidate_antigen_clustering.html#cb101-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> var_imp</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode python fold-hide"><code class="sourceCode python"><span id="cb102-1"><a href="id_04_candidate_antigen_clustering.html#cb102-1" aria-hidden="true" tabindex="-1"></a>var_imp_1 <span class="op">=</span> calculate_var_imp(purf, pf3d7_features_processed_1, pf3d7_outcome_1, num_cores, weights)</span>
<span id="cb102-2"><a href="id_04_candidate_antigen_clustering.html#cb102-2" aria-hidden="true" tabindex="-1"></a>var_imp_1.to_csv(<span class="st">&#39;./other_data/candidate_variable_importance_1.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb102-3"><a href="id_04_candidate_antigen_clustering.html#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="id_04_candidate_antigen_clustering.html#cb102-4" aria-hidden="true" tabindex="-1"></a>var_imp_2 <span class="op">=</span> calculate_var_imp(purf, pf3d7_features_processed_2, pf3d7_outcome_2, num_cores, weights)</span>
<span id="cb102-5"><a href="id_04_candidate_antigen_clustering.html#cb102-5" aria-hidden="true" tabindex="-1"></a>var_imp_2.to_csv(<span class="st">&#39;./other_data/candidate_variable_importance_2.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb102-6"><a href="id_04_candidate_antigen_clustering.html#cb102-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-7"><a href="id_04_candidate_antigen_clustering.html#cb102-7" aria-hidden="true" tabindex="-1"></a>var_imp_3 <span class="op">=</span> calculate_var_imp(purf, pf3d7_features_processed_3, pf3d7_outcome_3, num_cores, weights)</span>
<span id="cb102-8"><a href="id_04_candidate_antigen_clustering.html#cb102-8" aria-hidden="true" tabindex="-1"></a>var_imp_3.to_csv(<span class="st">&#39;./other_data/candidate_variable_importance_3.csv&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
<div id="wilcoxon-test-2" class="section level4 hasAnchor" number="4.3.1.2">
<h4><span class="header-section-number">4.3.1.2</span> Wilcoxon test<a href="id_04_candidate_antigen_clustering.html#wilcoxon-test-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Variable value comparison between candidate antigens and other random proteins predicted as negative.</p>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb103-1"><a href="id_04_candidate_antigen_clustering.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb103-2"><a href="id_04_candidate_antigen_clustering.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb104"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb104-1"><a href="id_04_candidate_antigen_clustering.html#cb104-1" aria-hidden="true" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./data/supplementary_data_4_purf_oob_predictions.csv&quot;</span>)</span>
<span id="cb104-2"><a href="id_04_candidate_antigen_clustering.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/clustering_groups.RData&quot;</span>)</span>
<span id="cb104-3"><a href="id_04_candidate_antigen_clustering.html#cb104-3" aria-hidden="true" tabindex="-1"></a>other_proteins <span class="ot">&lt;-</span> prediction[prediction<span class="sc">$</span>antigen_label <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> prediction<span class="sc">$</span>oob_score_with_tree_filtering <span class="sc">&lt;</span> <span class="fl">0.5</span>, ]<span class="sc">$</span>protein_id</span>
<span id="cb104-4"><a href="id_04_candidate_antigen_clustering.html#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">22</span>)</span>
<span id="cb104-5"><a href="id_04_candidate_antigen_clustering.html#cb104-5" aria-hidden="true" tabindex="-1"></a>random_protein_1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(other_proteins, <span class="at">size =</span> <span class="fu">length</span>(protein_id_1), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb104-6"><a href="id_04_candidate_antigen_clustering.html#cb104-6" aria-hidden="true" tabindex="-1"></a>random_protein_2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(other_proteins, <span class="at">size =</span> <span class="fu">length</span>(protein_id_2), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb104-7"><a href="id_04_candidate_antigen_clustering.html#cb104-7" aria-hidden="true" tabindex="-1"></a>random_protein_3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(other_proteins, <span class="at">size =</span> <span class="fu">length</span>(protein_id_3), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb104-8"><a href="id_04_candidate_antigen_clustering.html#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="id_04_candidate_antigen_clustering.html#cb104-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load imputed data</span></span>
<span id="cb104-10"><a href="id_04_candidate_antigen_clustering.html#cb104-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/pf_ml_input_processed_weighted.csv&quot;</span>)</span>
<span id="cb104-11"><a href="id_04_candidate_antigen_clustering.html#cb104-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[<span class="sc">!</span><span class="fu">duplicated</span>(data), ]</span>
<span id="cb104-12"><a href="id_04_candidate_antigen_clustering.html#cb104-12" aria-hidden="true" tabindex="-1"></a>compared_group_1 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>X, <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">%in%</span> protein_id_1) <span class="dv">1</span> <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">%in%</span> random_protein_1) <span class="dv">0</span> <span class="cf">else</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb104-13"><a href="id_04_candidate_antigen_clustering.html#cb104-13" aria-hidden="true" tabindex="-1"></a>compared_group_2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>X, <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">%in%</span> protein_id_2) <span class="dv">1</span> <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">%in%</span> random_protein_2) <span class="dv">0</span> <span class="cf">else</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb104-14"><a href="id_04_candidate_antigen_clustering.html#cb104-14" aria-hidden="true" tabindex="-1"></a>compared_group_3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(data<span class="sc">$</span>X, <span class="cf">function</span>(x) <span class="cf">if</span> (x <span class="sc">%in%</span> protein_id_3) <span class="dv">1</span> <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">%in%</span> random_protein_3) <span class="dv">0</span> <span class="cf">else</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb104-15"><a href="id_04_candidate_antigen_clustering.html#cb104-15" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[, <span class="dv">3</span><span class="sc">:</span><span class="fu">ncol</span>(data)]</span>
<span id="cb104-16"><a href="id_04_candidate_antigen_clustering.html#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="id_04_candidate_antigen_clustering.html#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Min-max normalization</span></span>
<span id="cb104-18"><a href="id_04_candidate_antigen_clustering.html#cb104-18" aria-hidden="true" tabindex="-1"></a>min_max <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb104-19"><a href="id_04_candidate_antigen_clustering.html#cb104-19" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb104-20"><a href="id_04_candidate_antigen_clustering.html#cb104-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-21"><a href="id_04_candidate_antigen_clustering.html#cb104-21" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(data, min_max))</span>
<span id="cb104-22"><a href="id_04_candidate_antigen_clustering.html#cb104-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-23"><a href="id_04_candidate_antigen_clustering.html#cb104-23" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(compared_group_1, compared_group_2, compared_group_3, data, <span class="at">file =</span> <span class="st">&quot;./rdata/candidate_antigen_wilcox_data.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb105-1"><a href="id_04_candidate_antigen_clustering.html#cb105-1" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb105-2"><a href="id_04_candidate_antigen_clustering.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb105-3"><a href="id_04_candidate_antigen_clustering.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">c</span>(pval, <span class="fu">wilcox.test</span>(data[compared_group_1 <span class="sc">==</span> <span class="dv">1</span>, i], data[compared_group_1 <span class="sc">==</span> <span class="dv">0</span>, i])<span class="sc">$</span>p.value)</span>
<span id="cb105-4"><a href="id_04_candidate_antigen_clustering.html#cb105-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-5"><a href="id_04_candidate_antigen_clustering.html#cb105-5" aria-hidden="true" tabindex="-1"></a>adj_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> <span class="fu">length</span>(pval))</span>
<span id="cb105-6"><a href="id_04_candidate_antigen_clustering.html#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_pval = -log10(adj_pval)</span></span>
<span id="cb105-7"><a href="id_04_candidate_antigen_clustering.html#cb105-7" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable =</span> <span class="fu">colnames</span>(data), <span class="at">adj_pval =</span> adj_pval)</span>
<span id="cb105-8"><a href="id_04_candidate_antigen_clustering.html#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(wilcox_res, <span class="st">&quot;./other_data/candidate_antigen_wilcox_res_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-9"><a href="id_04_candidate_antigen_clustering.html#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="id_04_candidate_antigen_clustering.html#cb105-10" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb105-11"><a href="id_04_candidate_antigen_clustering.html#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb105-12"><a href="id_04_candidate_antigen_clustering.html#cb105-12" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">c</span>(pval, <span class="fu">wilcox.test</span>(data[compared_group_2 <span class="sc">==</span> <span class="dv">1</span>, i], data[compared_group_2 <span class="sc">==</span> <span class="dv">0</span>, i])<span class="sc">$</span>p.value)</span>
<span id="cb105-13"><a href="id_04_candidate_antigen_clustering.html#cb105-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-14"><a href="id_04_candidate_antigen_clustering.html#cb105-14" aria-hidden="true" tabindex="-1"></a>adj_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> <span class="fu">length</span>(pval))</span>
<span id="cb105-15"><a href="id_04_candidate_antigen_clustering.html#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_pval = -log10(adj_pval)</span></span>
<span id="cb105-16"><a href="id_04_candidate_antigen_clustering.html#cb105-16" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable =</span> <span class="fu">colnames</span>(data), <span class="at">adj_pval =</span> adj_pval)</span>
<span id="cb105-17"><a href="id_04_candidate_antigen_clustering.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(wilcox_res, <span class="st">&quot;./other_data/candidate_antigen_wilcox_res_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb105-18"><a href="id_04_candidate_antigen_clustering.html#cb105-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-19"><a href="id_04_candidate_antigen_clustering.html#cb105-19" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb105-20"><a href="id_04_candidate_antigen_clustering.html#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(data)) {</span>
<span id="cb105-21"><a href="id_04_candidate_antigen_clustering.html#cb105-21" aria-hidden="true" tabindex="-1"></a>  pval <span class="ot">&lt;-</span> <span class="fu">c</span>(pval, <span class="fu">wilcox.test</span>(data[compared_group_3 <span class="sc">==</span> <span class="dv">1</span>, i], data[compared_group_3 <span class="sc">==</span> <span class="dv">0</span>, i])<span class="sc">$</span>p.value)</span>
<span id="cb105-22"><a href="id_04_candidate_antigen_clustering.html#cb105-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-23"><a href="id_04_candidate_antigen_clustering.html#cb105-23" aria-hidden="true" tabindex="-1"></a>adj_pval <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(pval, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>, <span class="at">n =</span> <span class="fu">length</span>(pval))</span>
<span id="cb105-24"><a href="id_04_candidate_antigen_clustering.html#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co"># adj_pval = -log10(adj_pval)</span></span>
<span id="cb105-25"><a href="id_04_candidate_antigen_clustering.html#cb105-25" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">variable =</span> <span class="fu">colnames</span>(data), <span class="at">adj_pval =</span> adj_pval)</span>
<span id="cb105-26"><a href="id_04_candidate_antigen_clustering.html#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(wilcox_res, <span class="st">&quot;./other_data/candidate_antigen_wilcox_res_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="plotting-7" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Plotting<a href="id_04_candidate_antigen_clustering.html#plotting-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb106-1"><a href="id_04_candidate_antigen_clustering.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb106-2"><a href="id_04_candidate_antigen_clustering.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb106-3"><a href="id_04_candidate_antigen_clustering.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span>
<span id="cb106-4"><a href="id_04_candidate_antigen_clustering.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sfsmisc)</span>
<span id="cb106-5"><a href="id_04_candidate_antigen_clustering.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb107-1"><a href="id_04_candidate_antigen_clustering.html#cb107-1" aria-hidden="true" tabindex="-1"></a>firstup <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb107-2"><a href="id_04_candidate_antigen_clustering.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">substr</span>(x, <span class="dv">1</span>, <span class="dv">1</span>) <span class="ot">&lt;-</span> <span class="fu">toupper</span>(<span class="fu">substr</span>(x, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb107-3"><a href="id_04_candidate_antigen_clustering.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb107-4"><a href="id_04_candidate_antigen_clustering.html#cb107-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-5"><a href="id_04_candidate_antigen_clustering.html#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="id_04_candidate_antigen_clustering.html#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="at">file =</span> <span class="st">&quot;./rdata/candidate_antigen_wilcox_data.RData&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb108-1"><a href="id_04_candidate_antigen_clustering.html#cb108-1" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_antigen_wilcox_res_1.csv&quot;</span>)</span>
<span id="cb108-2"><a href="id_04_candidate_antigen_clustering.html#cb108-2" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> data</span>
<span id="cb108-3"><a href="id_04_candidate_antigen_clustering.html#cb108-3" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> compared_group_1</span>
<span id="cb108-4"><a href="id_04_candidate_antigen_clustering.html#cb108-4" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/processed_candidate_variable_importance_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb108-5"><a href="id_04_candidate_antigen_clustering.html#cb108-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-6"><a href="id_04_candidate_antigen_clustering.html#cb108-6" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> wilcox_data[wilcox_data<span class="sc">$</span>compared_group <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb108-7"><a href="id_04_candidate_antigen_clustering.html#cb108-7" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(wilcox_data, <span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;compared_group&quot;</span>))</span>
<span id="cb108-8"><a href="id_04_candidate_antigen_clustering.html#cb108-8" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> wilcox_data, <span class="at">y =</span> <span class="fu">merge</span>(<span class="at">x =</span> var_imp, <span class="at">y =</span> wilcox_res, <span class="at">by.x =</span> <span class="st">&quot;row.names&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;variable&quot;</span>), <span class="at">by.x =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;Row.names&quot;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-9"><a href="id_04_candidate_antigen_clustering.html#cb108-9" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>tile_pos <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(wilcox_data))</span>
<span id="cb108-10"><a href="id_04_candidate_antigen_clustering.html#cb108-10" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(wilcox_data<span class="sc">$</span>compared_group)</span>
<span id="cb108-11"><a href="id_04_candidate_antigen_clustering.html#cb108-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-12"><a href="id_04_candidate_antigen_clustering.html#cb108-12" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">sapply</span>(wilcox_data<span class="sc">$</span>variable, <span class="cf">function</span>(x) {</span>
<span id="cb108-13"><a href="id_04_candidate_antigen_clustering.html#cb108-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb108-14"><a href="id_04_candidate_antigen_clustering.html#cb108-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb108-15"><a href="id_04_candidate_antigen_clustering.html#cb108-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb108-16"><a href="id_04_candidate_antigen_clustering.html#cb108-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb108-17"><a href="id_04_candidate_antigen_clustering.html#cb108-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-18"><a href="id_04_candidate_antigen_clustering.html#cb108-18" aria-hidden="true" tabindex="-1"></a>adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb108-19"><a href="id_04_candidate_antigen_clustering.html#cb108-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wilcox_data)) {</span>
<span id="cb108-20"><a href="id_04_candidate_antigen_clustering.html#cb108-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> wilcox_data<span class="sc">$</span>adj_pval[i]</span>
<span id="cb108-21"><a href="id_04_candidate_antigen_clustering.html#cb108-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">1e-3</span>) {</span>
<span id="cb108-22"><a href="id_04_candidate_antigen_clustering.html#cb108-22" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">round</span>(x, <span class="dv">3</span>))</span>
<span id="cb108-23"><a href="id_04_candidate_antigen_clustering.html#cb108-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb108-24"><a href="id_04_candidate_antigen_clustering.html#cb108-24" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;e&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb108-25"><a href="id_04_candidate_antigen_clustering.html#cb108-25" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">as.numeric</span>(a[<span class="dv">1</span>]), <span class="st">&quot; %*% 10^&quot;</span>, <span class="fu">as.integer</span>(a[<span class="dv">2</span>]))</span>
<span id="cb108-26"><a href="id_04_candidate_antigen_clustering.html#cb108-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb108-27"><a href="id_04_candidate_antigen_clustering.html#cb108-27" aria-hidden="true" tabindex="-1"></a>  adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(adj_pval_tmp, res)</span>
<span id="cb108-28"><a href="id_04_candidate_antigen_clustering.html#cb108-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb108-29"><a href="id_04_candidate_antigen_clustering.html#cb108-29" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>adj_pval <span class="ot">&lt;-</span> adj_pval_tmp</span>
<span id="cb108-30"><a href="id_04_candidate_antigen_clustering.html#cb108-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-31"><a href="id_04_candidate_antigen_clustering.html#cb108-31" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wilcox_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="st">`</span><span class="at">Mean decrease accuracy</span><span class="st">`</span>), <span class="at">y =</span> value, <span class="at">fill =</span> compared_group)) <span class="sc">+</span></span>
<span id="cb108-32"><a href="id_04_candidate_antigen_clustering.html#cb108-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb108-33"><a href="id_04_candidate_antigen_clustering.html#cb108-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb108-34"><a href="id_04_candidate_antigen_clustering.html#cb108-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb108-35"><a href="id_04_candidate_antigen_clustering.html#cb108-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>()</span>
<span id="cb108-36"><a href="id_04_candidate_antigen_clustering.html#cb108-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb108-37"><a href="id_04_candidate_antigen_clustering.html#cb108-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> adj_pval), <span class="at">y =</span> <span class="fl">1.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="at">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb108-38"><a href="id_04_candidate_antigen_clustering.html#cb108-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb108-39"><a href="id_04_candidate_antigen_clustering.html#cb108-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb108-40"><a href="id_04_candidate_antigen_clustering.html#cb108-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">sapply</span>(<span class="fu">c</span>(</span>
<span id="cb108-41"><a href="id_04_candidate_antigen_clustering.html#cb108-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;nonsynonymous_snps&quot;</span>,</span>
<span id="cb108-42"><a href="id_04_candidate_antigen_clustering.html#cb108-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_karplus_schulz_flexibility&quot;</span>,</span>
<span id="cb108-43"><a href="id_04_candidate_antigen_clustering.html#cb108-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_parker_hydrophilicity&quot;</span>,</span>
<span id="cb108-44"><a href="id_04_candidate_antigen_clustering.html#cb108-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;PmN&quot;</span>,</span>
<span id="cb108-45"><a href="id_04_candidate_antigen_clustering.html#cb108-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mitochondrial&quot;</span>,</span>
<span id="cb108-46"><a href="id_04_candidate_antigen_clustering.html#cb108-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;avg_parker_hydrophilicity&quot;</span>,</span>
<span id="cb108-47"><a href="id_04_candidate_antigen_clustering.html#cb108-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;hydrophobicity_Group3&quot;</span>,</span>
<span id="cb108-48"><a href="id_04_candidate_antigen_clustering.html#cb108-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;total_snps&quot;</span>,</span>
<span id="cb108-49"><a href="id_04_candidate_antigen_clustering.html#cb108-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;min_score_ifn_epitopes&quot;</span>,</span>
<span id="cb108-50"><a href="id_04_candidate_antigen_clustering.html#cb108-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;pi_value&quot;</span></span>
<span id="cb108-51"><a href="id_04_candidate_antigen_clustering.html#cb108-51" aria-hidden="true" tabindex="-1"></a>    ), <span class="cf">function</span>(x) {</span>
<span id="cb108-52"><a href="id_04_candidate_antigen_clustering.html#cb108-52" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb108-53"><a href="id_04_candidate_antigen_clustering.html#cb108-53" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb108-54"><a href="id_04_candidate_antigen_clustering.html#cb108-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb108-55"><a href="id_04_candidate_antigen_clustering.html#cb108-55" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb108-56"><a href="id_04_candidate_antigen_clustering.html#cb108-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb108-57"><a href="id_04_candidate_antigen_clustering.html#cb108-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Number non-synonymous SNPs&quot;</span>,</span>
<span id="cb108-58"><a href="id_04_candidate_antigen_clustering.html#cb108-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Karplus and Schulz flexibility&quot;</span>,</span>
<span id="cb108-59"><a href="id_04_candidate_antigen_clustering.html#cb108-59" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Parker hydrophilicity&quot;</span>,</span>
<span id="cb108-60"><a href="id_04_candidate_antigen_clustering.html#cb108-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">&quot;% positive charge a.a. - % negative charge a.a.&quot;</span>),</span>
<span id="cb108-61"><a href="id_04_candidate_antigen_clustering.html#cb108-61" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Mitochondrial&quot;</span>,</span>
<span id="cb108-62"><a href="id_04_candidate_antigen_clustering.html#cb108-62" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Average score of Parker hydrophilicity&quot;</span>,</span>
<span id="cb108-63"><a href="id_04_candidate_antigen_clustering.html#cb108-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">&quot;% hydrophobicity amino acids&quot;</span>),</span>
<span id="cb108-64"><a href="id_04_candidate_antigen_clustering.html#cb108-64" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Total number of SNPs&quot;</span>,</span>
<span id="cb108-65"><a href="id_04_candidate_antigen_clustering.html#cb108-65" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Minimum score of IFN-gamma inducing epitopes&quot;</span>,</span>
<span id="cb108-66"><a href="id_04_candidate_antigen_clustering.html#cb108-66" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Isoelectric point (PI) value&quot;</span></span>
<span id="cb108-67"><a href="id_04_candidate_antigen_clustering.html#cb108-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb108-68"><a href="id_04_candidate_antigen_clustering.html#cb108-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb108-69"><a href="id_04_candidate_antigen_clustering.html#cb108-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-70"><a href="id_04_candidate_antigen_clustering.html#cb108-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb108-71"><a href="id_04_candidate_antigen_clustering.html#cb108-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb108-72"><a href="id_04_candidate_antigen_clustering.html#cb108-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Candidate antigens&quot;</span>, <span class="st">&quot;Random predicted non-antigens&quot;</span>)</span>
<span id="cb108-73"><a href="id_04_candidate_antigen_clustering.html#cb108-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb108-74"><a href="id_04_candidate_antigen_clustering.html#cb108-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb108-75"><a href="id_04_candidate_antigen_clustering.html#cb108-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-76"><a href="id_04_candidate_antigen_clustering.html#cb108-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Normalized variable value&quot;</span>) <span class="sc">+</span></span>
<span id="cb108-77"><a href="id_04_candidate_antigen_clustering.html#cb108-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb108-78"><a href="id_04_candidate_antigen_clustering.html#cb108-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 1 (61 candidates)&quot;</span>)</span>
<span id="cb108-79"><a href="id_04_candidate_antigen_clustering.html#cb108-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-80"><a href="id_04_candidate_antigen_clustering.html#cb108-80" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">&lt;-</span> <span class="fu">get_legend</span>(p1 <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb108-81"><a href="id_04_candidate_antigen_clustering.html#cb108-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-82"><a href="id_04_candidate_antigen_clustering.html#cb108-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-83"><a href="id_04_candidate_antigen_clustering.html#cb108-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-84"><a href="id_04_candidate_antigen_clustering.html#cb108-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb108-85"><a href="id_04_candidate_antigen_clustering.html#cb108-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.9</span>)</span>
<span id="cb108-86"><a href="id_04_candidate_antigen_clustering.html#cb108-86" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb108-87"><a href="id_04_candidate_antigen_clustering.html#cb108-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-88"><a href="id_04_candidate_antigen_clustering.html#cb108-88" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p1 <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb108-89"><a href="id_04_candidate_antigen_clustering.html#cb108-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-90"><a href="id_04_candidate_antigen_clustering.html#cb108-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-91"><a href="id_04_candidate_antigen_clustering.html#cb108-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb108-92"><a href="id_04_candidate_antigen_clustering.html#cb108-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-93"><a href="id_04_candidate_antigen_clustering.html#cb108-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb108-94"><a href="id_04_candidate_antigen_clustering.html#cb108-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="dv">5</span>, <span class="dv">30</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb108-95"><a href="id_04_candidate_antigen_clustering.html#cb108-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-96"><a href="id_04_candidate_antigen_clustering.html#cb108-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-97"><a href="id_04_candidate_antigen_clustering.html#cb108-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-98"><a href="id_04_candidate_antigen_clustering.html#cb108-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-99"><a href="id_04_candidate_antigen_clustering.html#cb108-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb108-100"><a href="id_04_candidate_antigen_clustering.html#cb108-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb108-101"><a href="id_04_candidate_antigen_clustering.html#cb108-101" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb109"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb109-1"><a href="id_04_candidate_antigen_clustering.html#cb109-1" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_antigen_wilcox_res_2.csv&quot;</span>)</span>
<span id="cb109-2"><a href="id_04_candidate_antigen_clustering.html#cb109-2" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> data</span>
<span id="cb109-3"><a href="id_04_candidate_antigen_clustering.html#cb109-3" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> compared_group_2</span>
<span id="cb109-4"><a href="id_04_candidate_antigen_clustering.html#cb109-4" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/processed_candidate_variable_importance_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb109-5"><a href="id_04_candidate_antigen_clustering.html#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="id_04_candidate_antigen_clustering.html#cb109-6" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> wilcox_data[wilcox_data<span class="sc">$</span>compared_group <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb109-7"><a href="id_04_candidate_antigen_clustering.html#cb109-7" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(wilcox_data, <span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;compared_group&quot;</span>))</span>
<span id="cb109-8"><a href="id_04_candidate_antigen_clustering.html#cb109-8" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> wilcox_data, <span class="at">y =</span> <span class="fu">merge</span>(<span class="at">x =</span> var_imp, <span class="at">y =</span> wilcox_res, <span class="at">by.x =</span> <span class="st">&quot;row.names&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;variable&quot;</span>), <span class="at">by.x =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;Row.names&quot;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb109-9"><a href="id_04_candidate_antigen_clustering.html#cb109-9" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>tile_pos <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(wilcox_data))</span>
<span id="cb109-10"><a href="id_04_candidate_antigen_clustering.html#cb109-10" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(wilcox_data<span class="sc">$</span>compared_group)</span>
<span id="cb109-11"><a href="id_04_candidate_antigen_clustering.html#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="id_04_candidate_antigen_clustering.html#cb109-12" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">sapply</span>(wilcox_data<span class="sc">$</span>variable, <span class="cf">function</span>(x) {</span>
<span id="cb109-13"><a href="id_04_candidate_antigen_clustering.html#cb109-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb109-14"><a href="id_04_candidate_antigen_clustering.html#cb109-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb109-15"><a href="id_04_candidate_antigen_clustering.html#cb109-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb109-16"><a href="id_04_candidate_antigen_clustering.html#cb109-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb109-17"><a href="id_04_candidate_antigen_clustering.html#cb109-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-18"><a href="id_04_candidate_antigen_clustering.html#cb109-18" aria-hidden="true" tabindex="-1"></a>adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb109-19"><a href="id_04_candidate_antigen_clustering.html#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wilcox_data)) {</span>
<span id="cb109-20"><a href="id_04_candidate_antigen_clustering.html#cb109-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> wilcox_data<span class="sc">$</span>adj_pval[i]</span>
<span id="cb109-21"><a href="id_04_candidate_antigen_clustering.html#cb109-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">1e-3</span>) {</span>
<span id="cb109-22"><a href="id_04_candidate_antigen_clustering.html#cb109-22" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">round</span>(x, <span class="dv">3</span>))</span>
<span id="cb109-23"><a href="id_04_candidate_antigen_clustering.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb109-24"><a href="id_04_candidate_antigen_clustering.html#cb109-24" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;e&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb109-25"><a href="id_04_candidate_antigen_clustering.html#cb109-25" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">as.numeric</span>(a[<span class="dv">1</span>]), <span class="st">&quot; %*% 10^&quot;</span>, <span class="fu">as.integer</span>(a[<span class="dv">2</span>]))</span>
<span id="cb109-26"><a href="id_04_candidate_antigen_clustering.html#cb109-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb109-27"><a href="id_04_candidate_antigen_clustering.html#cb109-27" aria-hidden="true" tabindex="-1"></a>  adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(adj_pval_tmp, res)</span>
<span id="cb109-28"><a href="id_04_candidate_antigen_clustering.html#cb109-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-29"><a href="id_04_candidate_antigen_clustering.html#cb109-29" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>adj_pval <span class="ot">&lt;-</span> adj_pval_tmp</span>
<span id="cb109-30"><a href="id_04_candidate_antigen_clustering.html#cb109-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-31"><a href="id_04_candidate_antigen_clustering.html#cb109-31" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wilcox_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="st">`</span><span class="at">Mean decrease accuracy</span><span class="st">`</span>), <span class="at">y =</span> value, <span class="at">fill =</span> compared_group)) <span class="sc">+</span></span>
<span id="cb109-32"><a href="id_04_candidate_antigen_clustering.html#cb109-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb109-33"><a href="id_04_candidate_antigen_clustering.html#cb109-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb109-34"><a href="id_04_candidate_antigen_clustering.html#cb109-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb109-35"><a href="id_04_candidate_antigen_clustering.html#cb109-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>()</span>
<span id="cb109-36"><a href="id_04_candidate_antigen_clustering.html#cb109-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb109-37"><a href="id_04_candidate_antigen_clustering.html#cb109-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> adj_pval), <span class="at">y =</span> <span class="fl">1.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="at">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb109-38"><a href="id_04_candidate_antigen_clustering.html#cb109-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb109-39"><a href="id_04_candidate_antigen_clustering.html#cb109-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb109-40"><a href="id_04_candidate_antigen_clustering.html#cb109-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">sapply</span>(<span class="fu">c</span>(</span>
<span id="cb109-41"><a href="id_04_candidate_antigen_clustering.html#cb109-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_parker_hydrophilicity&quot;</span>,</span>
<span id="cb109-42"><a href="id_04_candidate_antigen_clustering.html#cb109-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;nonsynonymous_snps&quot;</span>,</span>
<span id="cb109-43"><a href="id_04_candidate_antigen_clustering.html#cb109-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_karplus_schulz_flexibility&quot;</span>,</span>
<span id="cb109-44"><a href="id_04_candidate_antigen_clustering.html#cb109-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cytoskeletal&quot;</span>,</span>
<span id="cb109-45"><a href="id_04_candidate_antigen_clustering.html#cb109-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mitochondrial&quot;</span>,</span>
<span id="cb109-46"><a href="id_04_candidate_antigen_clustering.html#cb109-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;hydrophobicity_Group3&quot;</span>,</span>
<span id="cb109-47"><a href="id_04_candidate_antigen_clustering.html#cb109-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;min_score_ifn_epitopes&quot;</span>,</span>
<span id="cb109-48"><a href="id_04_candidate_antigen_clustering.html#cb109-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;PmN&quot;</span>,</span>
<span id="cb109-49"><a href="id_04_candidate_antigen_clustering.html#cb109-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;total_snps&quot;</span>,</span>
<span id="cb109-50"><a href="id_04_candidate_antigen_clustering.html#cb109-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;avg_parker_hydrophilicity&quot;</span></span>
<span id="cb109-51"><a href="id_04_candidate_antigen_clustering.html#cb109-51" aria-hidden="true" tabindex="-1"></a>    ), <span class="cf">function</span>(x) {</span>
<span id="cb109-52"><a href="id_04_candidate_antigen_clustering.html#cb109-52" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb109-53"><a href="id_04_candidate_antigen_clustering.html#cb109-53" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb109-54"><a href="id_04_candidate_antigen_clustering.html#cb109-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb109-55"><a href="id_04_candidate_antigen_clustering.html#cb109-55" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb109-56"><a href="id_04_candidate_antigen_clustering.html#cb109-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb109-57"><a href="id_04_candidate_antigen_clustering.html#cb109-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Parker hydrophilicity&quot;</span>,</span>
<span id="cb109-58"><a href="id_04_candidate_antigen_clustering.html#cb109-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Number non-synonymous SNPs&quot;</span>,</span>
<span id="cb109-59"><a href="id_04_candidate_antigen_clustering.html#cb109-59" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Karplus and Schulz flexibility&quot;</span>,</span>
<span id="cb109-60"><a href="id_04_candidate_antigen_clustering.html#cb109-60" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Cytoskeletal&quot;</span>,</span>
<span id="cb109-61"><a href="id_04_candidate_antigen_clustering.html#cb109-61" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Mitochondrial&quot;</span>,</span>
<span id="cb109-62"><a href="id_04_candidate_antigen_clustering.html#cb109-62" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;% hydrophobicity amino acids&quot;</span>,</span>
<span id="cb109-63"><a href="id_04_candidate_antigen_clustering.html#cb109-63" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Minimum score of IFN-gamma inducing epitopes&quot;</span>,</span>
<span id="cb109-64"><a href="id_04_candidate_antigen_clustering.html#cb109-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">&quot;% positive charge a.a. - % negative charge a.a.&quot;</span>),</span>
<span id="cb109-65"><a href="id_04_candidate_antigen_clustering.html#cb109-65" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Total number of SNPs&quot;</span>,</span>
<span id="cb109-66"><a href="id_04_candidate_antigen_clustering.html#cb109-66" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Average score of Parker hydrophilicity&quot;</span></span>
<span id="cb109-67"><a href="id_04_candidate_antigen_clustering.html#cb109-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb109-68"><a href="id_04_candidate_antigen_clustering.html#cb109-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb109-69"><a href="id_04_candidate_antigen_clustering.html#cb109-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-70"><a href="id_04_candidate_antigen_clustering.html#cb109-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb109-71"><a href="id_04_candidate_antigen_clustering.html#cb109-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb109-72"><a href="id_04_candidate_antigen_clustering.html#cb109-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Candidate antigens&quot;</span>, <span class="st">&quot;Random predicted non-antigens&quot;</span>)</span>
<span id="cb109-73"><a href="id_04_candidate_antigen_clustering.html#cb109-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb109-74"><a href="id_04_candidate_antigen_clustering.html#cb109-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb109-75"><a href="id_04_candidate_antigen_clustering.html#cb109-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb109-76"><a href="id_04_candidate_antigen_clustering.html#cb109-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-77"><a href="id_04_candidate_antigen_clustering.html#cb109-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-78"><a href="id_04_candidate_antigen_clustering.html#cb109-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb109-79"><a href="id_04_candidate_antigen_clustering.html#cb109-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-80"><a href="id_04_candidate_antigen_clustering.html#cb109-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb109-81"><a href="id_04_candidate_antigen_clustering.html#cb109-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb109-82"><a href="id_04_candidate_antigen_clustering.html#cb109-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-83"><a href="id_04_candidate_antigen_clustering.html#cb109-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-84"><a href="id_04_candidate_antigen_clustering.html#cb109-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-85"><a href="id_04_candidate_antigen_clustering.html#cb109-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-86"><a href="id_04_candidate_antigen_clustering.html#cb109-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb109-87"><a href="id_04_candidate_antigen_clustering.html#cb109-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb109-88"><a href="id_04_candidate_antigen_clustering.html#cb109-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb109-89"><a href="id_04_candidate_antigen_clustering.html#cb109-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-90"><a href="id_04_candidate_antigen_clustering.html#cb109-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Normalized variable value&quot;</span>) <span class="sc">+</span></span>
<span id="cb109-91"><a href="id_04_candidate_antigen_clustering.html#cb109-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 2 (83 candidates)&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb110-1"><a href="id_04_candidate_antigen_clustering.html#cb110-1" aria-hidden="true" tabindex="-1"></a>wilcox_res <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_antigen_wilcox_res_3.csv&quot;</span>)</span>
<span id="cb110-2"><a href="id_04_candidate_antigen_clustering.html#cb110-2" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> data</span>
<span id="cb110-3"><a href="id_04_candidate_antigen_clustering.html#cb110-3" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> compared_group_3</span>
<span id="cb110-4"><a href="id_04_candidate_antigen_clustering.html#cb110-4" aria-hidden="true" tabindex="-1"></a>var_imp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/processed_candidate_variable_importance_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>, <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb110-5"><a href="id_04_candidate_antigen_clustering.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="id_04_candidate_antigen_clustering.html#cb110-6" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> wilcox_data[wilcox_data<span class="sc">$</span>compared_group <span class="sc">!=</span> <span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb110-7"><a href="id_04_candidate_antigen_clustering.html#cb110-7" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">melt</span>(wilcox_data, <span class="at">id =</span> <span class="fu">c</span>(<span class="st">&quot;compared_group&quot;</span>))</span>
<span id="cb110-8"><a href="id_04_candidate_antigen_clustering.html#cb110-8" aria-hidden="true" tabindex="-1"></a>wilcox_data <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> wilcox_data, <span class="at">y =</span> <span class="fu">merge</span>(<span class="at">x =</span> var_imp, <span class="at">y =</span> wilcox_res, <span class="at">by.x =</span> <span class="st">&quot;row.names&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;variable&quot;</span>), <span class="at">by.x =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;Row.names&quot;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb110-9"><a href="id_04_candidate_antigen_clustering.html#cb110-9" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>tile_pos <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(wilcox_data))</span>
<span id="cb110-10"><a href="id_04_candidate_antigen_clustering.html#cb110-10" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>compared_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(wilcox_data<span class="sc">$</span>compared_group)</span>
<span id="cb110-11"><a href="id_04_candidate_antigen_clustering.html#cb110-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-12"><a href="id_04_candidate_antigen_clustering.html#cb110-12" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">sapply</span>(wilcox_data<span class="sc">$</span>variable, <span class="cf">function</span>(x) {</span>
<span id="cb110-13"><a href="id_04_candidate_antigen_clustering.html#cb110-13" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb110-14"><a href="id_04_candidate_antigen_clustering.html#cb110-14" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb110-15"><a href="id_04_candidate_antigen_clustering.html#cb110-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb110-16"><a href="id_04_candidate_antigen_clustering.html#cb110-16" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb110-17"><a href="id_04_candidate_antigen_clustering.html#cb110-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-18"><a href="id_04_candidate_antigen_clustering.html#cb110-18" aria-hidden="true" tabindex="-1"></a>adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb110-19"><a href="id_04_candidate_antigen_clustering.html#cb110-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wilcox_data)) {</span>
<span id="cb110-20"><a href="id_04_candidate_antigen_clustering.html#cb110-20" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> wilcox_data<span class="sc">$</span>adj_pval[i]</span>
<span id="cb110-21"><a href="id_04_candidate_antigen_clustering.html#cb110-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&gt;=</span> <span class="fl">1e-3</span>) {</span>
<span id="cb110-22"><a href="id_04_candidate_antigen_clustering.html#cb110-22" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">round</span>(x, <span class="dv">3</span>))</span>
<span id="cb110-23"><a href="id_04_candidate_antigen_clustering.html#cb110-23" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb110-24"><a href="id_04_candidate_antigen_clustering.html#cb110-24" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(<span class="fu">format</span>(x, <span class="at">scientific =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">&quot;e&quot;</span>)[[<span class="dv">1</span>]]</span>
<span id="cb110-25"><a href="id_04_candidate_antigen_clustering.html#cb110-25" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;italic(p) == &quot;</span>, <span class="fu">as.numeric</span>(a[<span class="dv">1</span>]), <span class="st">&quot; %*% 10^&quot;</span>, <span class="fu">as.integer</span>(a[<span class="dv">2</span>]))</span>
<span id="cb110-26"><a href="id_04_candidate_antigen_clustering.html#cb110-26" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb110-27"><a href="id_04_candidate_antigen_clustering.html#cb110-27" aria-hidden="true" tabindex="-1"></a>  adj_pval_tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(adj_pval_tmp, res)</span>
<span id="cb110-28"><a href="id_04_candidate_antigen_clustering.html#cb110-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb110-29"><a href="id_04_candidate_antigen_clustering.html#cb110-29" aria-hidden="true" tabindex="-1"></a>wilcox_data<span class="sc">$</span>adj_pval <span class="ot">&lt;-</span> adj_pval_tmp</span>
<span id="cb110-30"><a href="id_04_candidate_antigen_clustering.html#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="id_04_candidate_antigen_clustering.html#cb110-31" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wilcox_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variable, <span class="st">`</span><span class="at">Mean decrease accuracy</span><span class="st">`</span>), <span class="at">y =</span> value, <span class="at">fill =</span> compared_group)) <span class="sc">+</span></span>
<span id="cb110-32"><a href="id_04_candidate_antigen_clustering.html#cb110-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.color =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">lwd =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb110-33"><a href="id_04_candidate_antigen_clustering.html#cb110-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb110-34"><a href="id_04_candidate_antigen_clustering.html#cb110-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">stroke =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">0.5</span>,</span>
<span id="cb110-35"><a href="id_04_candidate_antigen_clustering.html#cb110-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">position =</span> <span class="fu">position_jitterdodge</span>()</span>
<span id="cb110-36"><a href="id_04_candidate_antigen_clustering.html#cb110-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-37"><a href="id_04_candidate_antigen_clustering.html#cb110-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> adj_pval), <span class="at">y =</span> <span class="fl">1.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="at">family =</span> <span class="st">&quot;sans&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb110-38"><a href="id_04_candidate_antigen_clustering.html#cb110-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;grey80&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb110-39"><a href="id_04_candidate_antigen_clustering.html#cb110-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(</span>
<span id="cb110-40"><a href="id_04_candidate_antigen_clustering.html#cb110-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">sapply</span>(<span class="fu">c</span>(</span>
<span id="cb110-41"><a href="id_04_candidate_antigen_clustering.html#cb110-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;out_number_b_cell_epitopes_bepipred_1_0&quot;</span>,</span>
<span id="cb110-42"><a href="id_04_candidate_antigen_clustering.html#cb110-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_parker_hydrophilicity&quot;</span>,</span>
<span id="cb110-43"><a href="id_04_candidate_antigen_clustering.html#cb110-43" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;max_karplus_schulz_flexibility&quot;</span>,</span>
<span id="cb110-44"><a href="id_04_candidate_antigen_clustering.html#cb110-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;nonsynonymous_snps&quot;</span>,</span>
<span id="cb110-45"><a href="id_04_candidate_antigen_clustering.html#cb110-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;hydrophobicity_Group3&quot;</span>,</span>
<span id="cb110-46"><a href="id_04_candidate_antigen_clustering.html#cb110-46" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;cytoskeletal&quot;</span>,</span>
<span id="cb110-47"><a href="id_04_candidate_antigen_clustering.html#cb110-47" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;mitochondrial&quot;</span>,</span>
<span id="cb110-48"><a href="id_04_candidate_antigen_clustering.html#cb110-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;PmN&quot;</span>,</span>
<span id="cb110-49"><a href="id_04_candidate_antigen_clustering.html#cb110-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;avg_parker_hydrophilicity&quot;</span>,</span>
<span id="cb110-50"><a href="id_04_candidate_antigen_clustering.html#cb110-50" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;min_parker_hydrophilicity&quot;</span></span>
<span id="cb110-51"><a href="id_04_candidate_antigen_clustering.html#cb110-51" aria-hidden="true" tabindex="-1"></a>    ), <span class="cf">function</span>(x) {</span>
<span id="cb110-52"><a href="id_04_candidate_antigen_clustering.html#cb110-52" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(x, <span class="st">&quot;[_</span><span class="sc">\\</span><span class="st">.]&quot;</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb110-53"><a href="id_04_candidate_antigen_clustering.html#cb110-53" aria-hidden="true" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">firstup</span>(x)</span>
<span id="cb110-54"><a href="id_04_candidate_antigen_clustering.html#cb110-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(x)</span>
<span id="cb110-55"><a href="id_04_candidate_antigen_clustering.html#cb110-55" aria-hidden="true" tabindex="-1"></a>    }),</span>
<span id="cb110-56"><a href="id_04_candidate_antigen_clustering.html#cb110-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb110-57"><a href="id_04_candidate_antigen_clustering.html#cb110-57" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Number B-cell epitopes in outer membrane regions&quot;</span>,</span>
<span id="cb110-58"><a href="id_04_candidate_antigen_clustering.html#cb110-58" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Parker hydrophilicity&quot;</span>,</span>
<span id="cb110-59"><a href="id_04_candidate_antigen_clustering.html#cb110-59" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Maximum score of Karplus and Schulz flexibility&quot;</span>,</span>
<span id="cb110-60"><a href="id_04_candidate_antigen_clustering.html#cb110-60" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Number non-synonymous SNPs&quot;</span>,</span>
<span id="cb110-61"><a href="id_04_candidate_antigen_clustering.html#cb110-61" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">&quot;% hydrophobicity amino acids&quot;</span>),</span>
<span id="cb110-62"><a href="id_04_candidate_antigen_clustering.html#cb110-62" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Cytoskeletal&quot;</span>,</span>
<span id="cb110-63"><a href="id_04_candidate_antigen_clustering.html#cb110-63" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Mitochondrial&quot;</span>,</span>
<span id="cb110-64"><a href="id_04_candidate_antigen_clustering.html#cb110-64" aria-hidden="true" tabindex="-1"></a>      <span class="fu">expression</span>(<span class="st">&quot;% positive charge a.a. - % negative charge a.a.&quot;</span>),</span>
<span id="cb110-65"><a href="id_04_candidate_antigen_clustering.html#cb110-65" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Average score of Parker hydrophilicity&quot;</span>,</span>
<span id="cb110-66"><a href="id_04_candidate_antigen_clustering.html#cb110-66" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;Minimum score of Parker hydrophilicity&quot;</span></span>
<span id="cb110-67"><a href="id_04_candidate_antigen_clustering.html#cb110-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-68"><a href="id_04_candidate_antigen_clustering.html#cb110-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-69"><a href="id_04_candidate_antigen_clustering.html#cb110-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">clip =</span> <span class="st">&quot;off&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-70"><a href="id_04_candidate_antigen_clustering.html#cb110-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb110-71"><a href="id_04_candidate_antigen_clustering.html#cb110-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;0&quot;</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>),</span>
<span id="cb110-72"><a href="id_04_candidate_antigen_clustering.html#cb110-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Candidate antigens&quot;</span>, <span class="st">&quot;Random predicted non-antigens&quot;</span>)</span>
<span id="cb110-73"><a href="id_04_candidate_antigen_clustering.html#cb110-73" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-74"><a href="id_04_candidate_antigen_clustering.html#cb110-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb110-75"><a href="id_04_candidate_antigen_clustering.html#cb110-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb110-76"><a href="id_04_candidate_antigen_clustering.html#cb110-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-77"><a href="id_04_candidate_antigen_clustering.html#cb110-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-78"><a href="id_04_candidate_antigen_clustering.html#cb110-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb110-79"><a href="id_04_candidate_antigen_clustering.html#cb110-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-80"><a href="id_04_candidate_antigen_clustering.html#cb110-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb110-81"><a href="id_04_candidate_antigen_clustering.html#cb110-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(<span class="dv">10</span>, <span class="dv">70</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="st">&quot;pt&quot;</span>),</span>
<span id="cb110-82"><a href="id_04_candidate_antigen_clustering.html#cb110-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-83"><a href="id_04_candidate_antigen_clustering.html#cb110-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-84"><a href="id_04_candidate_antigen_clustering.html#cb110-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-85"><a href="id_04_candidate_antigen_clustering.html#cb110-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-86"><a href="id_04_candidate_antigen_clustering.html#cb110-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb110-87"><a href="id_04_candidate_antigen_clustering.html#cb110-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb110-88"><a href="id_04_candidate_antigen_clustering.html#cb110-88" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb110-89"><a href="id_04_candidate_antigen_clustering.html#cb110-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-90"><a href="id_04_candidate_antigen_clustering.html#cb110-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Normalized variable value&quot;</span>) <span class="sc">+</span></span>
<span id="cb110-91"><a href="id_04_candidate_antigen_clustering.html#cb110-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb110-92"><a href="id_04_candidate_antigen_clustering.html#cb110-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Group 3 (56 candidates)&quot;</span>)</span></code></pre></div>
<p><strong>Final plot</strong></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb111-1"><a href="id_04_candidate_antigen_clustering.html#cb111-1" aria-hidden="true" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> <span class="fu">plot_grid</span>(<span class="fu">plot_grid</span>(p1, p3, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)),</span>
<span id="cb111-2"><a href="id_04_candidate_antigen_clustering.html#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_grid</span>(p2,</span>
<span id="cb111-3"><a href="id_04_candidate_antigen_clustering.html#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb111-4"><a href="id_04_candidate_antigen_clustering.html#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot_grid</span>(<span class="cn">NULL</span>, legend, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.45</span>, <span class="fl">0.6</span>)),</span>
<span id="cb111-5"><a href="id_04_candidate_antigen_clustering.html#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NULL</span>,</span>
<span id="cb111-6"><a href="id_04_candidate_antigen_clustering.html#cb111-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.02</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>)</span>
<span id="cb111-7"><a href="id_04_candidate_antigen_clustering.html#cb111-7" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb111-8"><a href="id_04_candidate_antigen_clustering.html#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="fl">0.52</span>, <span class="fl">0.48</span>)</span>
<span id="cb111-9"><a href="id_04_candidate_antigen_clustering.html#cb111-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-10"><a href="id_04_candidate_antigen_clustering.html#cb111-10" aria-hidden="true" tabindex="-1"></a>p_combined</span></code></pre></div>
<p><img src="figures/Supplementary%20Fig%2010.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="comparison-of-important-variables" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Comparison of important variables<a href="id_04_candidate_antigen_clustering.html#comparison-of-important-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>In R: </strong></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb112-1"><a href="id_04_candidate_antigen_clustering.html#cb112-1" aria-hidden="true" tabindex="-1"></a>var_imp_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_variable_importance_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb112-2"><a href="id_04_candidate_antigen_clustering.html#cb112-2" aria-hidden="true" tabindex="-1"></a>var_imp_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_variable_importance_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb112-3"><a href="id_04_candidate_antigen_clustering.html#cb112-3" aria-hidden="true" tabindex="-1"></a>var_imp_3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_variable_importance_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb112-4"><a href="id_04_candidate_antigen_clustering.html#cb112-4" aria-hidden="true" tabindex="-1"></a>var_imp_1 <span class="ot">&lt;-</span> var_imp_1[<span class="fu">order</span>(<span class="sc">-</span>var_imp_1<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb112-5"><a href="id_04_candidate_antigen_clustering.html#cb112-5" aria-hidden="true" tabindex="-1"></a>var_imp_2 <span class="ot">&lt;-</span> var_imp_2[<span class="fu">order</span>(<span class="sc">-</span>var_imp_2<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb112-6"><a href="id_04_candidate_antigen_clustering.html#cb112-6" aria-hidden="true" tabindex="-1"></a>var_imp_3 <span class="ot">&lt;-</span> var_imp_3[<span class="fu">order</span>(<span class="sc">-</span>var_imp_3<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb112-7"><a href="id_04_candidate_antigen_clustering.html#cb112-7" aria-hidden="true" tabindex="-1"></a>var_imp_1<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>var_imp_1<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb112-8"><a href="id_04_candidate_antigen_clustering.html#cb112-8" aria-hidden="true" tabindex="-1"></a>var_imp_2<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>var_imp_2<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb112-9"><a href="id_04_candidate_antigen_clustering.html#cb112-9" aria-hidden="true" tabindex="-1"></a>var_imp_3<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>var_imp_3<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb112-10"><a href="id_04_candidate_antigen_clustering.html#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="id_04_candidate_antigen_clustering.html#cb112-11" aria-hidden="true" tabindex="-1"></a>var_imp_1<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> var_imp_2[<span class="fu">rownames</span>(var_imp_1), <span class="st">&quot;rank_2&quot;</span>]</span>
<span id="cb112-12"><a href="id_04_candidate_antigen_clustering.html#cb112-12" aria-hidden="true" tabindex="-1"></a>var_imp_1<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> var_imp_3[<span class="fu">rownames</span>(var_imp_1), <span class="st">&quot;rank_3&quot;</span>]</span>
<span id="cb112-13"><a href="id_04_candidate_antigen_clustering.html#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="id_04_candidate_antigen_clustering.html#cb112-14" aria-hidden="true" tabindex="-1"></a>var_imp_2<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> var_imp_1[<span class="fu">rownames</span>(var_imp_2), <span class="st">&quot;rank_1&quot;</span>]</span>
<span id="cb112-15"><a href="id_04_candidate_antigen_clustering.html#cb112-15" aria-hidden="true" tabindex="-1"></a>var_imp_2<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> var_imp_3[<span class="fu">rownames</span>(var_imp_2), <span class="st">&quot;rank_3&quot;</span>]</span>
<span id="cb112-16"><a href="id_04_candidate_antigen_clustering.html#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="id_04_candidate_antigen_clustering.html#cb112-17" aria-hidden="true" tabindex="-1"></a>var_imp_3<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> var_imp_1[<span class="fu">rownames</span>(var_imp_3), <span class="st">&quot;rank_1&quot;</span>]</span>
<span id="cb112-18"><a href="id_04_candidate_antigen_clustering.html#cb112-18" aria-hidden="true" tabindex="-1"></a>var_imp_3<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> var_imp_2[<span class="fu">rownames</span>(var_imp_3), <span class="st">&quot;rank_2&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb113-1"><a href="id_04_candidate_antigen_clustering.html#cb113-1" aria-hidden="true" tabindex="-1"></a>grp_var_imp_1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_group_variable_importance_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb113-2"><a href="id_04_candidate_antigen_clustering.html#cb113-2" aria-hidden="true" tabindex="-1"></a>grp_var_imp_2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_group_variable_importance_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb113-3"><a href="id_04_candidate_antigen_clustering.html#cb113-3" aria-hidden="true" tabindex="-1"></a>grp_var_imp_3 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;./other_data/candidate_group_variable_importance_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb113-4"><a href="id_04_candidate_antigen_clustering.html#cb113-4" aria-hidden="true" tabindex="-1"></a>grp_var_imp_1 <span class="ot">&lt;-</span> grp_var_imp_1[<span class="fu">order</span>(<span class="sc">-</span>grp_var_imp_1<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb113-5"><a href="id_04_candidate_antigen_clustering.html#cb113-5" aria-hidden="true" tabindex="-1"></a>grp_var_imp_2 <span class="ot">&lt;-</span> grp_var_imp_2[<span class="fu">order</span>(<span class="sc">-</span>grp_var_imp_2<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb113-6"><a href="id_04_candidate_antigen_clustering.html#cb113-6" aria-hidden="true" tabindex="-1"></a>grp_var_imp_3 <span class="ot">&lt;-</span> grp_var_imp_3[<span class="fu">order</span>(<span class="sc">-</span>grp_var_imp_3<span class="sc">$</span>meanDecreaseAccuracy), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb113-7"><a href="id_04_candidate_antigen_clustering.html#cb113-7" aria-hidden="true" tabindex="-1"></a>grp_var_imp_1<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>grp_var_imp_1<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb113-8"><a href="id_04_candidate_antigen_clustering.html#cb113-8" aria-hidden="true" tabindex="-1"></a>grp_var_imp_2<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>grp_var_imp_2<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb113-9"><a href="id_04_candidate_antigen_clustering.html#cb113-9" aria-hidden="true" tabindex="-1"></a>grp_var_imp_3<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="sc">-</span>grp_var_imp_3<span class="sc">$</span>meanDecreaseAccuracy)</span>
<span id="cb113-10"><a href="id_04_candidate_antigen_clustering.html#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="id_04_candidate_antigen_clustering.html#cb113-11" aria-hidden="true" tabindex="-1"></a>grp_var_imp_1<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> grp_var_imp_2[<span class="fu">rownames</span>(grp_var_imp_1), <span class="st">&quot;rank_2&quot;</span>]</span>
<span id="cb113-12"><a href="id_04_candidate_antigen_clustering.html#cb113-12" aria-hidden="true" tabindex="-1"></a>grp_var_imp_1<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> grp_var_imp_3[<span class="fu">rownames</span>(grp_var_imp_1), <span class="st">&quot;rank_3&quot;</span>]</span>
<span id="cb113-13"><a href="id_04_candidate_antigen_clustering.html#cb113-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-14"><a href="id_04_candidate_antigen_clustering.html#cb113-14" aria-hidden="true" tabindex="-1"></a>grp_var_imp_2<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> grp_var_imp_1[<span class="fu">rownames</span>(grp_var_imp_2), <span class="st">&quot;rank_1&quot;</span>]</span>
<span id="cb113-15"><a href="id_04_candidate_antigen_clustering.html#cb113-15" aria-hidden="true" tabindex="-1"></a>grp_var_imp_2<span class="sc">$</span>rank_3 <span class="ot">&lt;-</span> grp_var_imp_3[<span class="fu">rownames</span>(grp_var_imp_2), <span class="st">&quot;rank_3&quot;</span>]</span>
<span id="cb113-16"><a href="id_04_candidate_antigen_clustering.html#cb113-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-17"><a href="id_04_candidate_antigen_clustering.html#cb113-17" aria-hidden="true" tabindex="-1"></a>grp_var_imp_3<span class="sc">$</span>rank_1 <span class="ot">&lt;-</span> grp_var_imp_1[<span class="fu">rownames</span>(grp_var_imp_3), <span class="st">&quot;rank_1&quot;</span>]</span>
<span id="cb113-18"><a href="id_04_candidate_antigen_clustering.html#cb113-18" aria-hidden="true" tabindex="-1"></a>grp_var_imp_3<span class="sc">$</span>rank_2 <span class="ot">&lt;-</span> grp_var_imp_2[<span class="fu">rownames</span>(grp_var_imp_3), <span class="st">&quot;rank_2&quot;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb114-1"><a href="id_04_candidate_antigen_clustering.html#cb114-1" aria-hidden="true" tabindex="-1"></a>var_imp_1_ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(var_imp_1[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_2&quot;</span>, <span class="st">&quot;rank_3&quot;</span>)], grp_var_imp_1[, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_2&quot;</span>, <span class="st">&quot;rank_3&quot;</span>)])</span>
<span id="cb114-2"><a href="id_04_candidate_antigen_clustering.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="id_04_candidate_antigen_clustering.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_imp_1_) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean decrease accuracy&quot;</span>, <span class="st">&quot;Group 2 rank&quot;</span>, <span class="st">&quot;Group 3 rank&quot;</span>)</span>
<span id="cb114-4"><a href="id_04_candidate_antigen_clustering.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(var_imp_1_, <span class="st">&quot;./other_data/processed_candidate_variable_importance_1.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-5"><a href="id_04_candidate_antigen_clustering.html#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="id_04_candidate_antigen_clustering.html#cb114-6" aria-hidden="true" tabindex="-1"></a>var_imp_2_ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(var_imp_2[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_1&quot;</span>, <span class="st">&quot;rank_3&quot;</span>)], grp_var_imp_2[, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_1&quot;</span>, <span class="st">&quot;rank_3&quot;</span>)])</span>
<span id="cb114-7"><a href="id_04_candidate_antigen_clustering.html#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_imp_2_) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean decrease accuracy&quot;</span>, <span class="st">&quot;Group 1 rank&quot;</span>, <span class="st">&quot;Group 3 rank&quot;</span>)</span>
<span id="cb114-8"><a href="id_04_candidate_antigen_clustering.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(var_imp_2_, <span class="st">&quot;./other_data/processed_candidate_variable_importance_2.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb114-9"><a href="id_04_candidate_antigen_clustering.html#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="id_04_candidate_antigen_clustering.html#cb114-10" aria-hidden="true" tabindex="-1"></a>var_imp_3_ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(var_imp_3[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_1&quot;</span>, <span class="st">&quot;rank_2&quot;</span>)], grp_var_imp_3[, <span class="fu">c</span>(<span class="st">&quot;meanDecreaseAccuracy&quot;</span>, <span class="st">&quot;rank_1&quot;</span>, <span class="st">&quot;rank_2&quot;</span>)])</span>
<span id="cb114-11"><a href="id_04_candidate_antigen_clustering.html#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_imp_3_) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean decrease accuracy&quot;</span>, <span class="st">&quot;Group 1 rank&quot;</span>, <span class="st">&quot;Group 2 rank&quot;</span>)</span>
<span id="cb114-12"><a href="id_04_candidate_antigen_clustering.html#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(var_imp_3_, <span class="st">&quot;./other_data/processed_candidate_variable_importance_3.csv&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><strong>Group 1</strong></p>
<p><img src="figures/Table%201.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>Group 2</strong></p>
<p><img src="figures/Table%202.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>Group 3</strong></p>
<p><img src="figures/Table%203.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb115-1"><a href="id_04_candidate_antigen_clustering.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.3 (2023-03-15)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur ... 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] sfsmisc_1.1-13   umap_0.2.8.0     cluster_2.1.4    ggforce_0.3.4   
##  [5] ggbeeswarm_0.6.0 ggpubr_0.4.0     rlist_0.4.6.2    reshape2_1.4.4  
##  [9] cowplot_1.1.1    ggrepel_0.9.1    stringr_1.4.1    NbClust_3.0.1   
## [13] factoextra_1.0.7 ggplot2_3.4.2   
## 
## loaded via a namespace (and not attached):
##  [1] sass_0.4.2        tidyr_1.2.0       jsonlite_1.8.0    carData_3.0-5    
##  [5] R.utils_2.12.0    bslib_0.4.0       assertthat_0.2.1  askpass_1.1      
##  [9] highr_0.9         vipor_0.4.5       yaml_2.3.5        pillar_1.8.1     
## [13] backports_1.4.1   lattice_0.20-45   glue_1.6.2        reticulate_1.25  
## [17] digest_0.6.29     ggsignif_0.6.3    polyclip_1.10-0   colorspace_2.0-3 
## [21] htmltools_0.5.3   Matrix_1.5-3      R.oo_1.25.0       plyr_1.8.7       
## [25] pkgconfig_2.0.3   broom_1.0.0       bookdown_0.28     purrr_0.3.4      
## [29] scales_1.2.1      RSpectra_0.16-1   tweenr_2.0.1      openssl_2.0.2    
## [33] tibble_3.1.8      styler_1.8.0      generics_0.1.3    farver_2.1.1     
## [37] car_3.1-0         cachem_1.0.6      withr_2.5.0       cli_3.6.1        
## [41] magrittr_2.0.3    evaluate_0.16     R.methodsS3_1.8.2 fansi_1.0.3      
## [45] R.cache_0.16.0    MASS_7.3-58.2     rstatix_0.7.0     beeswarm_0.4.0   
## [49] tools_4.2.3       data.table_1.14.2 lifecycle_1.0.3   munsell_0.5.0    
## [53] compiler_4.2.3    jquerylib_0.1.4   rlang_1.1.0       grid_4.2.3       
## [57] rstudioapi_0.14   rmarkdown_2.16    codetools_0.2-19  gtable_0.3.0     
## [61] abind_1.4-5       DBI_1.1.3         R6_2.5.1          knitr_1.40       
## [65] dplyr_1.0.9       fastmap_1.1.0     utf8_1.2.2        stringi_1.7.8    
## [69] Rcpp_1.0.9        vctrs_0.6.2       png_0.1-7         tidyselect_1.1.2 
## [73] xfun_0.32</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="id_03_candidate_prioritization.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="id_05_further_characterization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["main_notebook.pdf", "PDF"]],
"search": false,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
